import{r as w,c as M,ac as I,cC as q,u as U,bj as C,cD as V,cE as B,j as h,cF as L,cG as G}from"./sanity-05ba3066.js";function K(n){const{validation:e}=n.type;if(!e)return!1;const r=Array.isArray(e)?e:[e];for(const o of r){let l=!1;const f=new Proxy({},{get:(g,y)=>()=>(y==="required"&&(l=!0),f)});if(typeof o=="function"&&(o(f),l)||typeof o=="object"&&o!==null&&"_required"in o&&o._required==="required")return!0}return!1}function _(n,e){let r=n;for(;r;){if(r.name===e||r.type&&r.type.name===e)return!0;r=r.type}return!1}function W(n){return _(n,"object")||n.jsonType==="object"||"fields"in n}function Y(n){return _(n,"array")}function k(n){return _(n,"reference")}function z(n){return _(n,"crossDatasetReference")}function H(n){return _(n,"string")}function J(n){return _(n,"number")}function x(n){let e=n;for(;e;){if(!e.type)return e;e=e.type}}function R(n){return"fields"in n?n.type?R(n.type).concat(n.fields):n.fields:[]}function Q(n){const e=new Set;function r(i,s){if(!e.has(i)){if(e.add(i),"fields"in i)for(const c of R(i)){const t=x(c.type);if(t.name==="document"){s.add(t);continue}let a;i.type.type?a=c.type.type.name:"jsonType"in i.type&&(a=c.type.jsonType),(a==="object"||a==="block")&&(k(c.type)?c.type.to.forEach(u=>s.add(u.type)):s.add(c.type)),r(c.type,s)}else if("of"in i)for(const c of i.of)r(c,s)}}const o=new Map;n.getTypeNames().forEach(i=>{const s=n.get(i);if(s===void 0||s.type===null)return;const c=new Set;r(s,c),o.set(s,c),e.clear()});const l=[],f=new Set,g=new Set;function y(i){if(g.has(i)||f.has(i))return;f.add(i);const s=o.get(i);s!==void 0&&s.forEach(c=>y(c)),f.delete(i),g.add(i),l.includes(i.name)||l.unshift(i.name)}for(const[i]of o)y(i);return l}const X=function(n){const e=M(6),{schemaType:r,theme:o}=n,{theme:l,scheme:f,tone:g}=o;let y;e[0]===Symbol.for("react.memo_cache_sentinel")?(y=new B,e[0]=y):y=e[0];const i=y;let s;return e[1]!==r.icon||e[2]!==f||e[3]!==l||e[4]!==g?(s=r.icon?h.jsx(L,{sheet:i.instance,children:h.jsx(G,{theme:l,scheme:f,tone:g,children:w.createElement(r.icon)})}):null,e[1]=r.icon,e[2]=f,e[3]=l,e[4]=g,e[5]=s):s=e[5],s},Z=n=>({_id:{type:"objectField",name:"_id",value:{type:"string"}},_type:{type:"objectField",name:"_type",value:{type:"string",value:n}},_createdAt:{type:"objectField",name:"_createdAt",value:{type:"string"}},_updatedAt:{type:"objectField",name:"_updatedAt",value:{type:"string"}},_rev:{type:"objectField",name:"_rev",value:{type:"string"}}});function T(n){var r;const e=(r=n.options)==null?void 0:r.list;return e&&Array.isArray(e)?{type:"union",of:e.map(o=>({type:"string",value:typeof o=="string"?o:o.value}))}:{type:"string"}}function ee(n){var r;const e=(r=n.options)==null?void 0:r.list;return e&&Array.isArray(e)?{type:"union",of:e.map(o=>({type:"number",value:typeof o=="number"?o:o.value}))}:{type:"number"}}function A(n,e=!1){const r={_ref:{type:"objectField",name:"_ref",value:{type:"string"}},_type:{type:"objectField",name:"_type",value:{type:"string",value:"reference"}},_weak:{type:"objectField",name:"_weak",value:{type:"boolean"},optional:!0}};return e&&(r._key={type:"objectField",name:"_key",value:{type:"string"}}),{type:"object",fields:r,dereferencesTo:n}}function te(n){const e=ne(n);return e.length===1?A(e[0]):{type:"union",of:e.map(r=>({type:"unionOption",name:r,value:A(r)}))}}function ne(n){const e=N(n);return[...new Set([...e.map(r=>r.name)])]}function N(n){const e="to"in n?n.to:[];return"type"in n&&k(n.type)?[...N(n.type),...e]:e}const S=new Map([["text",{type:"string"}],["url",{type:"string"}],["datetime",{type:"string"}],["date",{type:"string"}],["boolean",{type:"boolean"}],["email",{type:"string"}]]);function re(n,e){const r=new Set,{schema:o,basePath:l}=n;return Q(o).map(t=>{const a=o.get(t);if(a===void 0)return;const u=g(a);if(u!==null)return u.type==="type"&&r.add(a),u}).filter(t=>t!==void 0);function f(t){if(t.icon)return V(w.createElement(X,{schemaType:t,theme:e}))}function g(t){let a;if(t.type?a=t.type.name:"jsonType"in t&&(a=t.jsonType),a==="document"){const d=y(t);return d.type==="unknown"?null:{type:"document",name:t.name,title:typeof t.title=="string"?t.title:void 0,icon:f(t),fields:{...Z(t.name),...d.fields}}}const u=i(t);return u.type==="unknown"?null:u.type==="object"?{name:t.name,type:"type",value:{type:"object",fields:{_type:{type:"objectField",name:"_type",value:{type:"string",value:t.name}},...u.fields}}}:{name:t.name,title:typeof t.title=="string"?t.title:void 0,type:"type",value:u}}function y(t){const a={};for(const u of R(t)){const d=i(u.type);d!==null&&(a[u.name]={type:"objectField",name:u.name,title:typeof u.type.title=="string"?u.type.title:void 0,value:d,optional:K(u)===!1})}return{type:"object",fields:a}}function i(t){var u,d,b,p;if(((u=x(t))==null?void 0:u.name)==="document")return A(t.name);if(r.has(t.type))return{type:"inline",name:t.type.name};if(((b=(d=t.type)==null?void 0:d.type)==null?void 0:b.name)==="object")return{type:"inline",name:t.type.name};if(H(t))return T(t);if(J(t))return ee(t);const a=S.get(((p=t.type)==null?void 0:p.name)||"");if(a)return a;if(t.type&&S.has(t.type.name))return S.get(t.type.name);if(z(t))return{type:"unknown"};if(k(t))return te(t);if(Y(t))return c(t);if(W(t))return y(t);throw new Error(`Type "${t.name}" not found`)}function s(t,a){var b;const{options:u}=t;if(!u)return;const d={...u};return u.insertMenu&&(d.insertMenu={...u.insertMenu,views:(b=u.insertMenu.views)==null?void 0:b.map(p=>p.name==="grid"?{name:"grid",previewImageUrls:p.previewImageUrl?a.reduce((m,{name:v})=>{var F;const j=(F=p.previewImageUrl)==null?void 0:F.call(p,v);if(!j)return m;try{new URL(j),m[v]=j}catch{m[v]=new URL(j,`${window.location.origin}${l?`${l}/`:""}`).toString()}return m},{}):void 0}:p)}),d}function c(t){const a=[];for(const p of t.of){let m=i(p);const v={type:"unionOption",icon:f(p),name:p.name,title:typeof p.title=="string"?p.title:void 0,value:m};m.type==="inline"?m={type:"object",fields:{_key:E()},rest:m}:m.type==="object"&&(m.rest={type:"object",fields:{_key:E()}}),v.value=m,a.push(v)}if(a.length===0)return{type:"null"};if(a.length>1)return{type:"union",of:a,options:s(t,a)};const{name:u,title:d,value:b}=a[0];return{type:"array",of:{type:"arrayItem",name:u,title:typeof d=="string"?d:void 0,value:b}}}}function E(){return{type:"objectField",name:"_key",value:{type:"string"}}}function oe(n){const e=n.reduce((r,{id:o,path:l})=>(r[o]?r[o].add(l):r[o]=new Set([l]),r),{});return Object.entries(e)}function ie(n){const e=M(11),{comlink:r,perspective:o}=n,l=I(),f=q();let g,y;e[0]!==r||e[1]!==f||e[2]!==l?(g=()=>{const a=re(l,f);return r.post("presentation/schema",{schema:a}),r.on("visual-editing/schema",()=>({schema:a}))},y=[r,f,l],e[0]=r,e[1]=f,e[2]=l,e[3]=g,e[4]=y):(g=e[3],y=e[4]),w.useEffect(g,y);let i;e[5]===Symbol.for("react.memo_cache_sentinel")?(i={apiVersion:C},e[5]=i):i=e[5];const s=U(i);let c,t;return e[6]!==s||e[7]!==r||e[8]!==o?(c=()=>r.on("visual-editing/schema-union-types",async a=>{const u=oe(a.paths),d=await Promise.all(u.map(async p=>{const[m,v]=p,j=Array.from(v),F=`*[_id == $id][0]{${j.map(ue).join(",")}}`,$=await s.fetch(F,{id:m},{perspective:o,tag:"presentation-schema"}),P=j.map((D,O)=>({path:D,type:$[O]}));return{id:m,paths:P}})),b=new Map;return d.forEach(p=>{b.set(p.id,new Map(p.paths.map(ae)))}),{types:b}}),t=[r,s,o],e[6]=s,e[7]=r,e[8]=o,e[9]=c,e[10]=t):(c=e[9],t=e[10]),w.useEffect(c,t),null}function ae(n){const{path:e,type:r}=n;return[e,r]}function ue(n,e){return`"${e}": ${n}[0]._type`}var le=w.memo(ie);export{le as default};
