import{a0 as Vr,a1 as Fr,aT as Bt,aU as Kr,aV as sr,aW as Hr,r as f,aX as Mn,aY as Br,aZ as ir,a_ as Gt,a$ as an,b0 as Et,b1 as Pe,b2 as mt,b3 as Gr,ao as on,b4 as Xt,b5 as ar,b6 as hn,b7 as Xr,b8 as cn,b9 as Jr,ba as Qr,bb as Yr,bc as Zr,ap as or,bd as es,be as mn,bf as cr,h as pe,c as z,j as l,bg as Lt,bh as bt,a6 as Ee,O as kt,T as q,o as xe,bi as we,n as lr,u as Dt,bj as Ut,bk as fn,bl as dr,p as be,bm as ts,bn as ur,G as ns,t as dt,bo as pr,B as te,S as je,C as oe,bp as hr,bq as rs,br as ln,w as ss,F as J,bs as gn,bt as is,bu as mr,bv as zn,bw as fr,bx as as,by as os,m as At,k as $t,bz as cs,bA as vn,bB as ls,bC as ds,bD as us,I as ps,a as hs,aw as gr,bE as ms,bF as fs,a2 as yn,bG as vr,bH as gs,bI as vs,bJ as ys,M as bs,bK as xs,bL as Ln,ac as ws,bM as _s,bN as Ss,bO as Ps,bP as yr,bQ as js,bR as Es,bS as Rs,bT as Ts,aN as Cs,bU as br,bV as bn,bW as xr,bX as Is,a8 as ks,bY as As,bZ as $s,b_ as Os,aM as Ms,z as zs,b$ as Ls,c0 as Ds,c1 as Us,c2 as Ws,c3 as Ns,x as qs,c4 as Vs,c5 as Fs,c6 as Dn,c7 as Ks,c8 as Hs,c9 as Bs,ca as Gs,cb as wr,ah as _r,cc as Xs,cd as Js,s as Qs,al as Ys,ce as Zs,cf as ei}from"./sanity-05ba3066.js";import{i as ti,D as ni}from"./DisplayedDocumentBroadcaster-5ec2fcf3.js";function ri(t,e){return e===void 0&&(e=null),e=e??t,Vr(function(n,s){var r=[],i=0;n.subscribe(Fr(s,function(a){var o,c,d,p,u=null;i++%e===0&&r.push([]);try{for(var m=Bt(r),h=m.next();!h.done;h=m.next()){var b=h.value;b.push(a),t<=b.length&&(u=u??[],u.push(b))}}catch(y){o={error:y}}finally{try{h&&!h.done&&(c=m.return)&&c.call(m)}finally{if(o)throw o.error}}if(u)try{for(var x=Bt(u),v=x.next();!v.done;v=x.next()){var b=v.value;Kr(r,b),s.next(b)}}catch(y){d={error:y}}finally{try{v&&!v.done&&(p=x.return)&&p.call(x)}finally{if(d)throw d.error}}},function(){var a,o;try{for(var c=Bt(r),d=c.next();!d.done;d=c.next()){var p=d.value;s.next(p)}}catch(u){a={error:u}}finally{try{d&&!d.done&&(o=c.return)&&o.call(c)}finally{if(a)throw a.error}}s.complete()},void 0,function(){r=null}))})}const Un=new WeakMap;function si(t){return{config:t,start:(n,s)=>{const{self:r,system:i,emit:a}=s,o={receivers:void 0,dispose:void 0};Un.set(r,o),o.dispose=t({input:n.input,system:i,self:r,sendBack:c=>{r.getSnapshot().status!=="stopped"&&r._parent&&i._relay(r,r._parent,c)},receive:c=>{o.receivers??(o.receivers=new Set),o.receivers.add(c)},emit:a})},transition:(n,s,r)=>{var a,o;const i=Un.get(r.self);return s.type===sr?(n={...n,status:"stopped",error:void 0},(a=i.dispose)==null||a.call(i),n):((o=i.receivers)==null||o.forEach(c=>c(s)),n)},getInitialSnapshot:(n,s)=>({status:"active",output:void 0,error:void 0,input:s}),getPersistedSnapshot:n=>n,restoreSnapshot:n=>n}}const Wn="xstate.observable.error",Nn="xstate.observable.complete";function Sr(t){return{config:t,transition:(n,s)=>{if(n.status!=="active")return n;switch(s.type){case Wn:return{...n,status:"error",error:s.data,input:void 0,_subscription:void 0};case Nn:return{...n,status:"done",input:void 0,_subscription:void 0};case sr:return n._subscription.unsubscribe(),{...n,status:"stopped",input:void 0,_subscription:void 0};default:return n}},getInitialSnapshot:(n,s)=>({status:"active",output:void 0,error:void 0,context:void 0,input:s,_subscription:void 0}),start:(n,{self:s,system:r,emit:i})=>{n.status!=="done"&&(n._subscription=t({input:n.input,system:r,self:s,emit:i}).subscribe({next:a=>{s._parent&&r._relay(s,s._parent,a)},error:a=>{r._relay(s,s,{type:Wn,data:a})},complete:()=>{r._relay(s,s,{type:Nn})}}))},getPersistedSnapshot:({_subscription:n,...s})=>s,restoreSnapshot:n=>({...n,_subscription:void 0})}}function ii({children:t,isValidProp:e,...n}){e&&Hr(e),n={...f.useContext(Mn),...n},n.isStatic=Br(()=>n.isStatic);const s=f.useMemo(()=>n,[JSON.stringify(n.transition),n.transformPagePoint,n.reducedMotion]);return f.createElement(Mn.Provider,{value:s},t)}const xn="sanity.previewUrlSecret",ai="sanity-preview-url-secret",$e=`${ai}.share-access`,ut="sanity.previewUrlShareAccess",wn="2023-11-09",_n="sanity-preview-secret",Sn="sanity-preview-pathname",Pn="sanity-preview-perspective",Pr=60*60,oi=`*[_id == "${$e}" && _type == "${ut}"][0].secret`,ci=`*[_type == "${xn}" && dateTime(_updatedAt) <= dateTime(now()) - ${Pr}]`,jn="sanity.preview-url-secret";var Z=[];for(var Jt=0;Jt<256;++Jt)Z.push((Jt+256).toString(16).slice(1));function li(t,e=0){return(Z[t[e+0]]+Z[t[e+1]]+Z[t[e+2]]+Z[t[e+3]]+"-"+Z[t[e+4]]+Z[t[e+5]]+"-"+Z[t[e+6]]+Z[t[e+7]]+"-"+Z[t[e+8]]+Z[t[e+9]]+"-"+Z[t[e+10]]+Z[t[e+11]]+Z[t[e+12]]+Z[t[e+13]]+Z[t[e+14]]+Z[t[e+15]]).toLowerCase()}var Rt,di=new Uint8Array(16);function ui(){if(!Rt&&(Rt=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Rt))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Rt(di)}var pi=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);const qn={randomUUID:pi};function vt(t,e,n){if(qn.randomUUID&&!e&&!t)return qn.randomUUID();t=t||{};var s=t.random||(t.rng||ui)();if(s[6]=s[6]&15|64,s[8]=s[8]&63|128,e){n=n||0;for(var r=0;r<16;++r)e[n+r]=s[r];return e}return li(s)}const Vn=t=>({context:e})=>{const{count:n,include:s,exclude:r,responseType:i="message.received"}=t;return{count:n,domain:e.domain,from:e.connectTo,include:s?Array.isArray(s)?s:[s]:[],exclude:r?Array.isArray(r)?r:[r]:[],responseType:i,target:e.target,to:e.name}},hi=t=>e=>{const{data:n}=e;return(t.include.length?t.include.includes(n.type):!0)&&(t.exclude.length?!t.exclude.includes(n.type):!0)&&n.domain===t.domain&&n.from===t.from&&n.to===t.to&&(!t.target||e.source===t.target)},mi=t=>e=>({type:t,message:e}),fi=Yr(()=>cn(window,"message")),jr=t=>Sr(({input:e})=>fi.pipe(t?on(t):Xt(),ar(hi(e)),on(mi(e.responseType)),e.count?Xt(ri(e.count),Xr(n=>n),hn(e.count)):Xt())),En="sanity/comlink",gi=3e3,vi=500,yt="comlink/response",Ot="comlink/heartbeat",Rn="comlink/disconnect",Tn="comlink/handshake/syn",Cn="comlink/handshake/syn-ack",In="comlink/handshake/ack",yi=t=>e=>e.pipe(hn(1),on(()=>{throw new Error(t)})),Er=()=>ir({types:{},actors:{listen:Sr(({input:t})=>{const e=t.signal?cn(t.signal,"abort").pipe(yi(`Request ${t.requestId} aborted`)):Jr,n=s=>{var r,i;return((r=s.data)==null?void 0:r.type)===yt&&((i=s.data)==null?void 0:i.responseTo)===t.requestId&&!!s.source&&t.sources.has(s.source)};return cn(window,"message").pipe(ar(n),hn(t.sources.size),Qr(e))})},actions:{"send message":({context:t},e)=>{const{sources:n,targetOrigin:s}=t,{message:r}=e;n.forEach(i=>{i.postMessage(r,{targetOrigin:s})})},"on success":Gt(({context:t})=>t.parentRef,({context:t,self:e})=>{var n;return t.response&&((n=t.resolvable)==null||n.resolve(t.response)),{type:"request.success",requestId:e.id,response:t.response,responseTo:t.responseTo}}),"on fail":Gt(({context:t})=>t.parentRef,({context:t,self:e})=>{var n;return t.suppressWarnings||console.warn(`[@sanity/comlink] Received no response to message '${t.type}' on client '${t.from}' (ID: '${t.id}').`),(n=t.resolvable)==null||n.reject(new Error("No response received")),{type:"request.failed",requestId:e.id}}),"on abort":Gt(({context:t})=>t.parentRef,({context:t,self:e})=>{var n;return(n=t.resolvable)==null||n.reject(new Error("Request aborted")),{type:"request.aborted",requestId:e.id}})},guards:{expectsResponse:({context:t})=>t.expectResponse},delays:{initialTimeout:0,responseTimeout:({context:t})=>t.responseTimeout??gi}}).createMachine({context:({input:t})=>({channelId:t.channelId,data:t.data,domain:t.domain,expectResponse:t.expectResponse??!1,from:t.from,id:`msg-${vt()}`,parentRef:t.parentRef,resolvable:t.resolvable,response:null,responseTimeout:t.responseTimeout,responseTo:t.responseTo,signal:t.signal,sources:t.sources instanceof Set?t.sources:new Set([t.sources]),suppressWarnings:t.suppressWarnings,targetOrigin:t.targetOrigin,to:t.to,type:t.type}),initial:"idle",on:{abort:".aborted"},states:{idle:{after:{initialTimeout:[{target:"sending"}]}},sending:{entry:{type:"send message",params:({context:t})=>{const{channelId:e,data:n,domain:s,from:r,id:i,responseTo:a,to:o,type:c}=t;return{message:{channelId:e,data:n,domain:s,from:r,id:i,to:o,type:c,responseTo:a}}}},always:[{guard:"expectsResponse",target:"awaiting"},"success"]},awaiting:{invoke:{id:"listen for response",src:"listen",input:({context:t})=>({requestId:t.id,sources:t.sources,signal:t.signal}),onError:"aborted"},after:{responseTimeout:"failed"},on:{message:{actions:an({response:({event:t})=>t.data.data,responseTo:({event:t})=>t.data.responseTo}),target:"success"}}},failed:{type:"final",entry:"on fail"},success:{type:"final",entry:"on success"},aborted:{type:"final",entry:"on abort"}},output:({context:t,self:e})=>({requestId:e.id,response:t.response,responseTo:t.responseTo})}),bi=si(({sendBack:t,input:e})=>{const n=()=>{t(e.event)};e.immediate&&n();const s=setInterval(n,e.interval);return()=>{clearInterval(s)}}),Mt=()=>ir({types:{},actors:{requestMachine:Er(),listen:jr(),sendBackAtInterval:bi},actions:{"buffer message":Et(({enqueue:t})=>{t.assign({buffer:({event:e,context:n})=>(Pe(e,"post"),[...n.buffer,e.data])}),t.emit(({event:e})=>(Pe(e,"post"),{type:"_buffer.added",message:e.data}))}),"create request":an({requests:({context:t,event:e,self:n,spawn:s})=>{Pe(e,"request");const r=(Array.isArray(e.data)?e.data:[e.data]).map(i=>{const a=`req-${vt()}`;return s("requestMachine",{id:a,input:{channelId:t.channelId,data:i.data,domain:t.domain,expectResponse:i.expectResponse,from:t.name,parentRef:n,responseTo:i.responseTo,sources:t.target,targetOrigin:t.targetOrigin,to:t.connectTo,type:i.type}})});return[...t.requests,...r]}}),"emit received message":Et(({enqueue:t})=>{t.emit(({event:e})=>(Pe(e,"message.received"),{type:"_message",message:e.message.data})),t.emit(({event:e})=>(Pe(e,"message.received"),{type:e.message.data.type,message:e.message.data}))}),"flush buffer":Et(({enqueue:t})=>{t.raise(({context:e})=>({type:"request",data:e.buffer.map(({data:n,type:s})=>({data:n,type:s}))})),t.emit(({context:e})=>({type:"_buffer.flushed",messages:e.buffer})),t.assign({buffer:[]})}),post:mt(({event:t})=>(Pe(t,"post"),{type:"request",data:{data:t.data.data,expectResponse:!0,type:t.data.type}})),"remove request":Et(({context:t,enqueue:e,event:n})=>{Pe(n,["request.success","request.failed","request.aborted"]),Gr(n.requestId),e.assign({requests:t.requests.filter(({id:s})=>s!==n.requestId)})}),respond:mt(({event:t})=>(Pe(t,"response"),{type:"request",data:{data:t.data,type:yt,responseTo:t.respondTo}})),"send handshake ack":mt({type:"request",data:{type:In}}),"send disconnect":mt(()=>({type:"request",data:{type:Rn}})),"send handshake syn":mt({type:"request",data:{type:Tn}}),"set target":an({target:({event:t})=>(Pe(t,"target.set"),t.target)})},guards:{"has target":({context:t})=>!!t.target,"should send heartbeats":({context:t})=>t.heartbeat}}).createMachine({id:"connection",context:({input:t})=>({id:t.id||`${t.name}-${vt()}`,buffer:[],channelId:`chn-${vt()}`,connectTo:t.connectTo,domain:t.domain??En,heartbeat:t.heartbeat??!1,name:t.name,requests:[],target:t.target,targetOrigin:t.targetOrigin}),on:{"target.set":{actions:"set target"},"request.success":{actions:"remove request"},"request.failed":{actions:"remove request"}},initial:"idle",states:{idle:{on:{connect:{target:"handshaking",guard:"has target"},post:{actions:"buffer message"}}},handshaking:{id:"handshaking",invoke:[{id:"send syn",src:"sendBackAtInterval",input:()=>({event:{type:"syn"},interval:vi,immediate:!0})},{id:"listen for handshake",src:"listen",input:t=>Vn({include:Cn,count:1})(t)}],on:{syn:{actions:"send handshake syn"},request:{actions:"create request"},post:{actions:"buffer message"},"message.received":{target:"connected"},disconnect:{target:"disconnected"}},exit:"send handshake ack"},connected:{entry:"flush buffer",invoke:{id:"listen for messages",src:"listen",input:Vn({exclude:[yt,Ot]})},on:{post:{actions:"post"},request:{actions:"create request"},response:{actions:"respond"},"message.received":{actions:"emit received message"},disconnect:{target:"disconnected"}},initial:"heartbeat",states:{heartbeat:{initial:"checking",states:{checking:{always:{guard:"should send heartbeats",target:"sending"}},sending:{on:{"request.failed":{target:"#handshaking"}},invoke:{id:"send heartbeat",src:"sendBackAtInterval",input:()=>({event:{type:"post",data:{type:Ot,data:void 0}},interval:2e3,immediate:!1})}}}}}},disconnected:{id:"disconnected",entry:"send disconnect",on:{request:{actions:"create request"},post:{actions:"buffer message"},connect:{target:"handshaking",guard:"has target"}}}}}),Qt=(t,e=Mt())=>{const n=t.id||`${t.name}-${vt()}`,s=Zr(e,{input:{...t,id:n}}),r=(m,h)=>{const{unsubscribe:b}=s.on(m,async x=>{const v=await h(x.message.data);v&&s.send({type:"response",respondTo:x.message.id,data:v})});return b},i=()=>{s.send({type:"connect"})},a=()=>{s.send({type:"disconnect"})},o=m=>{const h=s.getSnapshot();let b=typeof h.value=="string"?h.value:Object.keys(h.value)[0];const{unsubscribe:x}=s.subscribe(v=>{const y=typeof v.value=="string"?v.value:Object.keys(v.value)[0];b!==y&&(b=y,m(y))});return x},c=m=>{s.send({type:"target.set",target:m})},d=(m,h)=>{const b={type:m,data:h};s.send({type:"post",data:b})},p=()=>{s.stop()},u=()=>(s.start(),p);return{actor:s,connect:i,disconnect:a,id:n,name:t.name,machine:e,on:r,onStatus:o,post:d,setTarget:c,start:u,stop:p,get target(){return s.getSnapshot().context.target}}},Yt=t=>{t.disconnect(),setTimeout(()=>{t.stop()},0)},xi=()=>{},wi=t=>{const{targetOrigin:e}=t,n=new Set,s=new Set;return{addTarget:r=>{if(n.has(r))return xi;if(!n.size||!s.size)return n.add(r),s.forEach(a=>{a.connections.forEach(o=>{o.setTarget(r),o.connect()})}),()=>{n.delete(r),s.forEach(a=>{a.connections.forEach(o=>{o.target===r&&o.disconnect()})})};n.add(r);const i=new Set;return s.forEach(a=>{const o=Qt({...a.input,target:r,targetOrigin:e},a.machine);i.add(o),a.connections.add(o),a.subscribers.forEach(({type:c,handler:d,unsubscribers:p})=>{p.push(o.on(c,d))}),a.internalEventSubscribers.forEach(({type:c,handler:d,unsubscribers:p})=>{p.push(o.actor.on(c,d).unsubscribe)}),a.statusSubscribers.forEach(({handler:c,unsubscribers:d})=>{d.push(o.onStatus(p=>c({connection:o.id,status:p})))}),o.start(),o.connect()}),()=>{n.delete(r),i.forEach(a=>{Yt(a),s.forEach(o=>{o.connections.delete(a)})})}},createChannel:(r,i=Mt())=>{const a={connections:new Set,input:r,internalEventSubscribers:new Set,machine:i,statusSubscribers:new Set,subscribers:new Set};s.add(a);const{connections:o,internalEventSubscribers:c,statusSubscribers:d,subscribers:p}=a;if(n.size)n.forEach(v=>{const y=Qt({...r,target:v,targetOrigin:e},i);o.add(y)});else{const v=Qt({...r,targetOrigin:e},i);o.add(v)}const u=(...v)=>{const[y,_]=v;o.forEach(S=>{S.post(y,_)})},m=(v,y)=>{const _=[];o.forEach(w=>{_.push(w.on(v,y))});const S={type:v,handler:y,unsubscribers:_};return p.add(S),()=>{_.forEach(w=>w()),p.delete(S)}},h=(v,y)=>{const _=[];o.forEach(w=>{_.push(w.actor.on(v,y).unsubscribe)});const S={type:v,handler:y,unsubscribers:_};return c.add(S),()=>{_.forEach(w=>w()),c.delete(S)}},b=v=>{const y=[];o.forEach(S=>{y.push(S.onStatus(w=>v({connection:S.id,status:w})))});const _={handler:v,unsubscribers:y};return d.add(_),()=>{y.forEach(S=>S()),d.delete(_)}},x=()=>{const v=a.connections;v.forEach(Yt),v.clear(),s.delete(a)};return{on:m,onInternalEvent:h,onStatus:b,post:u,start:()=>(o.forEach(v=>{v.start(),v.connect()}),x),stop:x}},destroy:()=>{s.forEach(({connections:r})=>{r.forEach(Yt),r.clear()}),s.clear(),n.clear()}}},_i=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,kn=/_key\s*==\s*['"](.*)['"]/,Si=/^\d*:\d*$/;function An(t){return typeof t=="number"||typeof t=="string"&&/^\[\d+\]$/.test(t)}function Wt(t){return typeof t=="string"?kn.test(t.trim()):typeof t=="object"&&"_key"in t}function Rr(t){if(typeof t=="string"&&Si.test(t))return!0;if(!Array.isArray(t)||t.length!==2)return!1;const[e,n]=t;return(typeof e=="number"||e==="")&&(typeof n=="number"||n==="")}function Pi(t,e,n){const s=typeof e=="string"?Tr(e):e;if(!Array.isArray(s))throw new Error("Path must be an array or a string");let r=t;for(let i=0;i<s.length;i++){const a=s[i];if(An(a)){if(!Array.isArray(r))return n;r=r[a]}if(Wt(a)){if(!Array.isArray(r))return n;r=r.find(o=>o._key===a._key)}if(typeof a=="string"&&(r=typeof r=="object"&&r!==null?r[a]:void 0),typeof r>"u")return n}return r}function ji(t){if(!Array.isArray(t))throw new Error("Path is not an array");return t.reduce((e,n,s)=>{const r=typeof n;if(r==="number")return`${e}[${n}]`;if(r==="string")return`${e}${s===0?"":"."}${n}`;if(Wt(n)&&n._key)return`${e}[_key=="${n._key}"]`;if(Array.isArray(n)){const[i,a]=n;return`${e}[${i}:${a}]`}throw new Error(`Unsupported path segment \`${JSON.stringify(n)}\``)},"")}function Tr(t){if(typeof t!="string")throw new Error("Path is not a string");const e=t.match(_i);if(!e)throw new Error("Invalid path string");return e.map(Ei)}function Ei(t){return An(t)?Ri(t):Wt(t)?Ti(t):Rr(t)?Ci(t):t}function Ri(t){return Number(t.replace(/[^\d]/g,""))}function Ti(t){return{_key:t.match(kn)[1]}}function Ci(t){const[e,n]=t.split(":").map(s=>s===""?s:Number(s));return[e,n]}var Cr=Object.freeze({__proto__:null,fromString:Tr,get:Pi,isIndexSegment:An,isIndexTuple:Rr,isKeySegment:Wt,reKeySegment:kn,toString:ji});const Fn="drafts.";function lc(t){return t.startsWith(Fn)?t.slice(Fn.length):t}const Kn={"\f":"\\f","\n":"\\n","\r":"\\r","	":"\\t","'":"\\'","\\":"\\\\"},Hn={"\\f":"\f","\\n":`
`,"\\r":"\r","\\t":"	","\\'":"'","\\\\":"\\"};function Ii(t){return`$${t.map(e=>typeof e=="string"?`['${e.replace(/[\f\n\r\t'\\]/g,n=>Kn[n])}']`:typeof e=="number"?`[${e}]`:e._key!==""?`[?(@._key=='${e._key.replace(/['\\]/g,n=>Kn[n])}')]`:`[${e._index}]`).join("")}`}function dc(t){const e=[],n=/\['(.*?)'\]|\[(\d+)\]|\[\?\(@\._key=='(.*?)'\)\]/g;let s;for(;(s=n.exec(t))!==null;){if(s[1]!==void 0){const r=s[1].replace(/\\(\\|f|n|r|t|')/g,i=>Hn[i]);e.push(r);continue}if(s[2]!==void 0){e.push(parseInt(s[2],10));continue}if(s[3]!==void 0){const r=s[3].replace(/\\(\\')/g,i=>Hn[i]);e.push({_key:r,_index:-1});continue}}return e}function ki(t){return t.map(e=>{if(typeof e=="string"||typeof e=="number")return e;if(e._index!==-1)return e._index;throw new Error(`invalid segment:${JSON.stringify(e)}`)})}function uc(t,e){if(!(e!=null&&e.mappings))return;const n=Ii(ki(t));if(e.mappings[n]!==void 0)return{mapping:e.mappings[n],matchedPath:n,pathSuffix:""};const s=Object.entries(e.mappings).filter(([o])=>n.startsWith(o)).sort(([o],[c])=>c.length-o.length);if(s.length==0)return;const[r,i]=s[0],a=n.substring(r.length);return{mapping:i,matchedPath:r,pathSuffix:a}}function Ai(t){return t!==null&&Array.isArray(t)}function Bn(t){return typeof t=="object"&&t!==null}function ft(t,e,n=[]){if(Ai(t))return t.map((s,r)=>{if(Bn(s)){const i=s._key;if(typeof i=="string")return ft(s,e,n.concat({_key:i,_index:r}))}return ft(s,e,n.concat(r))});if(Bn(t)){if(t._type==="block"||t._type==="span"){const s={...t};return t._type==="block"?s.children=ft(t.children,e,n.concat("children")):t._type==="span"&&(s.text=ft(t.text,e,n.concat("text"))),s}return Object.fromEntries(Object.entries(t).map(([s,r])=>[s,ft(r,e,n.concat(s))]))}return e(t,n)}function $i(t){const e=new URL(t),{searchParams:n}=e;return n.delete(Sn),n.delete(_n),n.delete(Pn),e}function Oi(t,e,n,s){const r=new URL(t),{searchParams:i}=r;return i.set(_n,e),i.set(Sn,n),i.set(Pn,s),r}function Ir(){if(typeof crypto<"u"){const t=new Uint8Array(16);crypto.getRandomValues(t);let e="";for(let n=0;n<t.length;n++)e+=t[n].toString(16).padStart(2,"0");return e=btoa(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/[=]+$/,""),e}return Math.random().toString(36).slice(2)}async function Mi(t,e,n,s){const r=t.withConfig({apiVersion:wn}),i=Ir(),a=r.patch($e).set({secret:i,studioUrl:n,userId:s});return await r.transaction().createIfNotExists({_id:$e,_type:ut,source:e,studioUrl:n,userId:s}).patch(a).commit({tag:jn}),{secret:i}}async function zi(t,e,n,s){const r=t.withConfig({apiVersion:wn}),i=r.patch($e).set({secret:null,studioUrl:n,userId:s});await r.transaction().createIfNotExists({_id:$e,_type:ut,source:e,studioUrl:n,userId:s}).patch(i).commit({tag:jn})}function Li(t){for(var e=[],n=0;n<t.length;){var s=t[n];if(s==="*"||s==="+"||s==="?"){e.push({type:"MODIFIER",index:n,value:t[n++]});continue}if(s==="\\"){e.push({type:"ESCAPED_CHAR",index:n++,value:t[n++]});continue}if(s==="{"){e.push({type:"OPEN",index:n,value:t[n++]});continue}if(s==="}"){e.push({type:"CLOSE",index:n,value:t[n++]});continue}if(s===":"){for(var r="",i=n+1;i<t.length;){var a=t.charCodeAt(i);if(a>=48&&a<=57||a>=65&&a<=90||a>=97&&a<=122||a===95){r+=t[i++];continue}break}if(!r)throw new TypeError("Missing parameter name at ".concat(n));e.push({type:"NAME",index:n,value:r}),n=i;continue}if(s==="("){var o=1,c="",i=n+1;if(t[i]==="?")throw new TypeError('Pattern cannot start with "?" at '.concat(i));for(;i<t.length;){if(t[i]==="\\"){c+=t[i++]+t[i++];continue}if(t[i]===")"){if(o--,o===0){i++;break}}else if(t[i]==="("&&(o++,t[i+1]!=="?"))throw new TypeError("Capturing groups are not allowed at ".concat(i));c+=t[i++]}if(o)throw new TypeError("Unbalanced pattern at ".concat(n));if(!c)throw new TypeError("Missing pattern at ".concat(n));e.push({type:"PATTERN",index:n,value:c}),n=i;continue}e.push({type:"CHAR",index:n,value:t[n++]})}return e.push({type:"END",index:n,value:""}),e}function Di(t,e){e===void 0&&(e={});for(var n=Li(t),s=e.prefixes,r=s===void 0?"./":s,i=e.delimiter,a=i===void 0?"/#?":i,o=[],c=0,d=0,p="",u=function(g){if(d<n.length&&n[d].type===g)return n[d++].value},m=function(g){var P=u(g);if(P!==void 0)return P;var I=n[d],C=I.type,k=I.index;throw new TypeError("Unexpected ".concat(C," at ").concat(k,", expected ").concat(g))},h=function(){for(var g="",P;P=u("CHAR")||u("ESCAPED_CHAR");)g+=P;return g},b=function(g){for(var P=0,I=a;P<I.length;P++){var C=I[P];if(g.indexOf(C)>-1)return!0}return!1},x=function(g){var P=o[o.length-1],I=g||(P&&typeof P=="string"?P:"");if(P&&!I)throw new TypeError('Must have text between two parameters, missing text after "'.concat(P.name,'"'));return!I||b(I)?"[^".concat(Ae(a),"]+?"):"(?:(?!".concat(Ae(I),")[^").concat(Ae(a),"])+?")};d<n.length;){var v=u("CHAR"),y=u("NAME"),_=u("PATTERN");if(y||_){var S=v||"";r.indexOf(S)===-1&&(p+=S,S=""),p&&(o.push(p),p=""),o.push({name:y||c++,prefix:S,suffix:"",pattern:_||x(S),modifier:u("MODIFIER")||""});continue}var w=v||u("ESCAPED_CHAR");if(w){p+=w;continue}p&&(o.push(p),p="");var E=u("OPEN");if(E){var S=h(),R=u("NAME")||"",j=u("PATTERN")||"",T=h();m("CLOSE"),o.push({name:R||(j?c++:""),pattern:R&&!j?x(S):j,prefix:S,suffix:T,modifier:u("MODIFIER")||""});continue}m("END")}return o}function Ui(t,e){var n=[],s=Ar(t,n,e);return Wi(s,n,e)}function Wi(t,e,n){n===void 0&&(n={});var s=n.decode,r=s===void 0?function(i){return i}:s;return function(i){var a=t.exec(i);if(!a)return!1;for(var o=a[0],c=a.index,d=Object.create(null),p=function(m){if(a[m]===void 0)return"continue";var h=e[m-1];h.modifier==="*"||h.modifier==="+"?d[h.name]=a[m].split(h.prefix+h.suffix).map(function(b){return r(b,h)}):d[h.name]=r(a[m],h)},u=1;u<a.length;u++)p(u);return{path:o,index:c,params:d}}}function Ae(t){return t.replace(/([.+*?=^!:${}()[\]|/\\])/g,"\\$1")}function kr(t){return t&&t.sensitive?"":"i"}function Ni(t,e){if(!e)return t;for(var n=/\((?:\?<(.*?)>)?(?!\?)/g,s=0,r=n.exec(t.source);r;)e.push({name:r[1]||s++,prefix:"",suffix:"",modifier:"",pattern:""}),r=n.exec(t.source);return t}function qi(t,e,n){var s=t.map(function(r){return Ar(r,e,n).source});return new RegExp("(?:".concat(s.join("|"),")"),kr(n))}function Vi(t,e,n){return Fi(Di(t,n),e,n)}function Fi(t,e,n){n===void 0&&(n={});for(var s=n.strict,r=s===void 0?!1:s,i=n.start,a=i===void 0?!0:i,o=n.end,c=o===void 0?!0:o,d=n.encode,p=d===void 0?function(P){return P}:d,u=n.delimiter,m=u===void 0?"/#?":u,h=n.endsWith,b=h===void 0?"":h,x="[".concat(Ae(b),"]|$"),v="[".concat(Ae(m),"]"),y=a?"^":"",_=0,S=t;_<S.length;_++){var w=S[_];if(typeof w=="string")y+=Ae(p(w));else{var E=Ae(p(w.prefix)),R=Ae(p(w.suffix));if(w.pattern)if(e&&e.push(w),E||R)if(w.modifier==="+"||w.modifier==="*"){var j=w.modifier==="*"?"?":"";y+="(?:".concat(E,"((?:").concat(w.pattern,")(?:").concat(R).concat(E,"(?:").concat(w.pattern,"))*)").concat(R,")").concat(j)}else y+="(?:".concat(E,"(").concat(w.pattern,")").concat(R,")").concat(w.modifier);else{if(w.modifier==="+"||w.modifier==="*")throw new TypeError('Can not repeat "'.concat(w.name,'" without a prefix and suffix'));y+="(".concat(w.pattern,")").concat(w.modifier)}else y+="(?:".concat(E).concat(R,")").concat(w.modifier)}}if(c)r||(y+="".concat(v,"?")),y+=n.endsWith?"(?=".concat(x,")"):"$";else{var T=t[t.length-1],g=typeof T=="string"?v.indexOf(T[T.length-1])>-1:T===void 0;r||(y+="(?:".concat(v,"(?=").concat(x,"))?")),g||(y+="(?=".concat(v,"|").concat(x,")"))}return new RegExp(y,kr(n))}function Ar(t,e,n){return t instanceof RegExp?Ni(t,e):Array.isArray(t)?qi(t,e,n):Vi(t,e,n)}async function Ki(t,e,n,s,r=or()){const i=t.withConfig({apiVersion:wn});try{const a=new Date(Date.now()+1e3*Pr),o=`drafts.${r}`,c=Ir(),d=i.patch(o).set({secret:c,source:e,studioUrl:n,userId:s});return await i.transaction().createOrReplace({_id:o,_type:xn}).patch(d).commit({tag:jn}),{secret:c,expiresAt:a}}finally{try{await i.delete({query:ci})}catch(a){console.error("Failed to delete expired secrets",a)}}}function Hi(t){const{draftMode:e,previewMode:n,origin:s=typeof location>"u"?"https://localhost":location.origin}=t,r=(n==null?void 0:n.enable)||(e==null?void 0:e.enable);let{preview:i="/"}=t;const a=new URL(i,s),o=r?new URL(r,s):void 0;return async c=>{try{if(c.previewSearchParam){const p=new URL(c.previewSearchParam,a);p.origin===a.origin&&(i=`${p.pathname}${p.search}`)}}catch{}typeof location<"u"&&location.origin===a.origin&&c.studioBasePath&&(i.startsWith(`${c.studioBasePath}/`)||i===c.studioBasePath)&&(i=t.preview||"/");const d=new URL(i,a);if(o){const p=new URL(o),{searchParams:u}=p;return u.set(_n,c.previewUrlSecret),u.set(Pn,c.studioPreviewPerspective),d.pathname!==p.pathname&&u.set(Sn,`${d.pathname}${d.search}`),p.toString()}return d.toString()}}const Bi=t=>typeof t=="object"&&typeof t.then=="function",Tt=[];function Gi(t,e,n=(s,r)=>s===r){if(t===e)return!0;if(!t||!e)return!1;const s=t.length;if(e.length!==s)return!1;for(let r=0;r<s;r++)if(!n(t[r],e[r]))return!1;return!0}function Xi(t,e=null,n=!1,s={}){e===null&&(e=[t]);for(const i of Tt)if(Gi(e,i.keys,i.equal)){if(n)return;if(Object.prototype.hasOwnProperty.call(i,"error"))throw i.error;if(Object.prototype.hasOwnProperty.call(i,"response"))return s.lifespan&&s.lifespan>0&&(i.timeout&&clearTimeout(i.timeout),i.timeout=setTimeout(i.remove,s.lifespan)),i.response;if(!n)throw i.promise}const r={keys:e,equal:s.equal,remove:()=>{const i=Tt.indexOf(r);i!==-1&&Tt.splice(i,1)},promise:(Bi(t)?t:t(...e)).then(i=>{r.response=i,s.lifespan&&s.lifespan>0&&(r.timeout=setTimeout(r.remove,s.lifespan))}).catch(i=>r.error=i)};if(Tt.push(r),!n)throw r.promise}const $r=(t,e,n)=>Xi(t,e,!1,n),Ji=/^([\w-]+):(0|[1-9][0-9]*)$/,Qi=/^([\w-]+):([0-9]+),([0-9]+)$/,Yi=/^([\w-]+):([\w-]+)$/;function Zi(t){const e=[];for(const n of t.split(".")){const s=Ji.exec(n);if(s){e.push(s[1],Number(s[2]));continue}const r=Qi.exec(n);if(r){e.push(r[1],[Number(r[2]),Number(r[3])]);continue}const i=Yi.exec(n);if(i){e.push(i[1],{_key:i[2]});continue}e.push(n)}return e}const pt=es(vn(),cs(1)),gt=mn(pt);cr({baseUrl:pt,dataset:gt,id:pt,path:pt,projectId:gt,tool:gt,type:gt,workspace:gt,isDraft:mn(vn())});cr({origin:pt,href:pt,data:mn(ls(vn(),us()))});const ea={"handshake/syn":Tn,"handshake/syn-ack":Cn,"handshake/ack":In,"channel/response":yt,"channel/heartbeat":Ot,"channel/disconnect":Rn,"overlay/focus":"visual-editing/focus","overlay/navigate":"visual-editing/navigate","overlay/toggle":"visual-editing/toggle","presentation/toggleOverlay":"presentation/toggle-overlay"},ta={[Tn]:"handshake/syn",[Cn]:"handshake/syn-ack",[In]:"handshake/ack",[yt]:"channel/response",[Ot]:"channel/heartbeat",[Rn]:"channel/disconnect","visual-editing/focus":"overlay/focus","visual-editing/navigate":"overlay/navigate","visual-editing/toggle":"overlay/toggle","presentation/toggle-overlay":"presentation/toggleOverlay"},na=t=>{const{data:e}=t;return e&&typeof e=="object"&&"domain"in e&&"type"in e&&"from"in e&&"to"in e&&(e.domain==="sanity/channels"&&(e.domain=En),e.to==="overlays"&&(e.to="visual-editing"),e.from==="overlays"&&(e.from="visual-editing"),e.channelId=e.connectionId,delete e.connectionId,e.type=ea[e.type]??e.type),t},ra=t=>{const{channelId:e,...n}=t,s={...n,connectionId:e};return s.domain===En&&(s.domain="sanity/channels"),s.to==="visual-editing"&&(s.to="overlays"),s.from==="visual-editing"&&(s.from="overlays"),s.type=ta[s.type]??s.type,s.type==="channel/response"&&s.responseTo&&!s.data&&(s.data={responseTo:s.responseTo}),(s.type==="handshake/syn"||s.type==="handshake/syn-ack"||s.type==="handshake/ack")&&(s.data={id:s.connectionId}),s},sa=({context:t},e)=>{const{sources:n,targetOrigin:s}=t,r=ra(e.message);n.forEach(i=>{i.postMessage(r,{targetOrigin:s})})},dn=()=>({listen:jr(na),requestMachine:Er().provide({actions:{"send message":sa}})});function ia(t,e){return`${t}-${typeof e=="string"?e:JSON.stringify(e)}`}const aa=typeof window<"u"&&/Mac|iPod|iPhone|iPad/.test(window.navigator.platform),Gn={alt:"altKey",ctrl:"ctrlKey",mod:aa?"metaKey":"ctrlKey",shift:"shiftKey"};function oa(t,e){return t.every(n=>Gn[n]?e[Gn[n]]:e.key===n.toUpperCase())}function Xn(t){return t.key==="Alt"}function Or(t,e){let n;return(...s)=>{clearTimeout(n),n=setTimeout(()=>{t.apply(t,s)},e)}}const ca=function(t){const e=z(14),{comlink:n,children:s}=t;let r;e[0]===Symbol.for("react.memo_cache_sentinel")?(r={},e[0]=r):r=e[0];const i=f.useRef(r);let a,o;e[1]!==n?(a=()=>n==null?void 0:n.on("visual-editing/shared-state",()=>({state:i.current})),o=[n],e[1]=n,e[2]=a,e[3]=o):(a=e[2],o=e[3]),f.useEffect(a,o);let c;e[4]!==n?(c=(v,y)=>{i.current[v]=y,n==null||n.post("presentation/shared-state",{key:v,value:y})},e[4]=n,e[5]=c):c=e[5];const d=c;let p;e[6]!==n?(p=v=>{n==null||n.post("presentation/shared-state",{key:v}),delete i.current[v]},e[6]=n,e[7]=p):p=e[7];const u=p;let m,h;e[8]!==u||e[9]!==d?(h={removeValue:u,setValue:d},e[8]=u,e[9]=d,e[10]=h):h=e[10],m=h;const b=m;let x;return e[11]!==s||e[12]!==b?(x=l.jsx(js.Provider,{value:b,children:s}),e[11]=s,e[12]=b,e[13]=x):x=e[13],x},Nt=f.createContext(null);Nt.displayName="PanelsContext";const la=pe.div`
  overflow: hidden;
  flex-basis: 0;
  flex-shrink: 1;
`,$n=function(t){const e=z(15),{children:n,defaultSize:s,id:r,minWidth:i,maxWidth:a,order:o}=t,c=s===void 0?null:s,d=o===void 0?0:o,p=f.useContext(Nt);if(p===null)throw Error("Panel components must be rendered within a PanelGroup container");const{getPanelStyle:u,registerElement:m,unregisterElement:h}=p;let b;e[0]!==u||e[1]!==r?(b=u(r),e[0]=u,e[1]=r,e[2]=b):b=e[2];const x=b;let v,y;e[3]!==c||e[4]!==r||e[5]!==a||e[6]!==i||e[7]!==d||e[8]!==m||e[9]!==h?(v=()=>(m(r,{id:r,type:"panel",defaultSize:c,maxWidth:a??null,minWidth:i??0,order:d}),()=>{h(r)}),y=[r,c,d,a,i,m,h],e[3]=c,e[4]=r,e[5]=a,e[6]=i,e[7]=d,e[8]=m,e[9]=h,e[10]=v,e[11]=y):(v=e[10],y=e[11]),f.useLayoutEffect(v,y);let _;return e[12]!==n||e[13]!==x?(_=l.jsx(la,{style:x,children:n}),e[12]=n,e[13]=x,e[14]=_):_=e[14],_},Mr="presentation/panels",zr=()=>JSON.parse(localStorage.getItem(Mr)||"{}"),da=t=>{localStorage.setItem(Mr,JSON.stringify(t))},Lr=t=>t.map(e=>[e.id,e.order].join(":")).join(",");function ua(){const t=z(1);let e;const n=ha,s=pa;let r;if(t[0]===Symbol.for("react.memo_cache_sentinel")){const i=Or(s,100);r={get:n,set:s,setDebounced:i},t[0]=r}else r=t[0];return e=r,e}function pa(t,e){const n=zr(),s=Lr(t),r={...n,[s]:e};da(r)}function ha(t){const e=zr(),n=Lr(t);return Array.isArray(e[n])&&e[n].some(ma)?void 0:e[n]}function ma(t){return t===null}function un(t,e,n){const{maxWidth:s,minWidth:r}=t,i=s==null?100:s/n*100,a=r/n*100;return Math.min(i,Math.max(a,e))}function fa(t,e,n,s,r,i){const{panels:a,widths:o}=r,{widths:c}=i,d=c||o,p=[...d];{const b=t<0?s:n,x=a.findIndex(_=>_.id===b.id),v=d[x],y=un(b,v+Math.abs(t),e);if(v===y)return d;t=t<0?v-y:y-v}let u=0,m=t<0?n:s,h=a.findIndex(b=>b.id===m.id);for(;;){const b=a[h],x=d[h],v=Math.abs(t)-Math.abs(u),y=un(b,x-v,e);if(x!==y&&(u+=x-y,p[h]=y,u.toPrecision(10).localeCompare(Math.abs(t).toPrecision(10),void 0,{numeric:!0})>=0))break;if(t<0){if(--h<0)break}else if(++h>=a.length)break}return u===0?d:(m=t<0?s:n,h=a.findIndex(b=>b.id===m.id),p[h]=d[h]+u,p)}function ga(t,e,n){if(t.length===1)return"100";const s=t.findIndex(i=>i.id===e),r=n[s];return r==null?"0":r.toPrecision(10)}function Jn(t,e,n=0,s=null){const r=t.clientX,i=(s||e.getBoundingClientRect()).left;return r-i-n}function Zt(t){return t.type==="panel"}function Qn(t){return t.type==="resizer"}function Yn(t){return Array.from(t.values()).sort(({order:e},{order:n})=>e==null&&n==null?0:e==null?-1:n==null?1:e-n)}function Zn(t,e,n){const s=e.reduce((a,o)=>a+o,0),r=[...e].map(a=>a/s*100);let i=0;for(let a=0;a<t.length;a++){const o=t[a],c=r[a],d=un(o,c,n);c!=d&&(i+=c-d,r[a]=d)}if(i.toFixed(3)!=="0.000")for(let a=0;a<t.length;a++){const o=t[a];let{maxWidth:c,minWidth:d}=o;d=d/n*100,c!=null&&(c=c/n*100);const p=Math.min(c??100,Math.max(d,r[a]+i));if(p!==r[a]&&(i-=p-r[a],r[a]=p,Math.abs(i).toFixed(3)==="0.000"))break}return r}function va(t){let e=t.length,n=100;const s=t.map(i=>i.defaultSize?(n=n-i.defaultSize,e=e-1,i.defaultSize):null),r=n/e;return s.map(i=>i===null?r:i)}const ya=pe.div`
  display: flex;
  flex-direction: row;
  height: 100%;
  overflow: hidden;
  width: 100%;
`,ba=function(t){const e=z(46),{children:n}=t,s=f.useRef(null);let r;e[0]===Symbol.for("react.memo_cache_sentinel")?(r=new Map,e[0]=r):r=e[0];const[i,a]=f.useState(r);let o,c;e[1]!==i?(c=Yn(i).filter(Zt),e[1]=i,e[2]=c):c=e[2],o=c;const d=o;let p;e[3]===Symbol.for("react.memo_cache_sentinel")?(p=[],e[3]=p):p=e[3];const[u,m]=f.useState(p),[h,b]=f.useState(null);let x;e[4]!==i||e[5]!==d||e[6]!==u?(x={elements:i,panels:d,widths:u},e[4]=i,e[5]=d,e[6]=u,e[7]=x):x=e[7];const v=f.useRef(x);let y;e[8]!==h||e[9]!==d||e[10]!==u?(y=V=>({flexGrow:ga(d,V,u),pointerEvents:h===null?void 0:"none"}),e[8]=h,e[9]=d,e[10]=u,e[11]=y):y=e[11];const _=y;let S;e[12]===Symbol.for("react.memo_cache_sentinel")?(S=(V,H)=>{a(F=>{if(F.has(V))return F;const X=new Map(F);return X.set(V,H),X})},e[12]=S):S=e[12];const w=S;let E;e[13]===Symbol.for("react.memo_cache_sentinel")?(E=V=>{a(H=>{if(!H.has(V))return H;const F=new Map(H);return F.delete(V),F})},e[13]=E):E=e[13];const R=E;let j;e[14]===Symbol.for("react.memo_cache_sentinel")?(j={containerWidth:window.innerWidth,dragOffset:0,panelAfter:null,panelBefore:null,resizerIndex:-1,resizerRect:null,startX:0,widths:[]},e[14]=j):j=e[14];const T=f.useRef(j);let g;e[15]!==i?(g=(V,H)=>{const F=Yn(i),X=F.findIndex(Y=>Y.id===V),B=i.get(V);if(!B||!Qn(B))return;const ae=B.el.current;ae&&(T.current={resizerIndex:X,panelBefore:F.reduce((Y,Q,se)=>Zt(Q)&&se<X?Q:Y,null),panelAfter:F.reduce((Y,Q,se)=>Y===null&&Zt(Q)&&se>X?Q:Y,null),containerWidth:window.innerWidth,startX:H.pageX,dragOffset:Jn(H,ae),resizerRect:ae.getBoundingClientRect(),widths:v.current.widths},b(V))},e[15]=i,e[16]=g):g=e[16];const P=g;let I;e[17]===Symbol.for("react.memo_cache_sentinel")?(I=()=>{b(null)},e[17]=I):I=e[17];const C=I;let k;e[18]!==i?(k=(V,H)=>{H.preventDefault(),H.stopPropagation();const{containerWidth:F,dragOffset:X,panelBefore:B,panelAfter:ae,resizerRect:Y}=T.current;if(B==null||ae==null)return;const Q=i.get(V);if(!Q||!Qn(Q))return;const se=Q.el.current;if(!se)return;const de=Jn(H,se,X,Y);if(de===0)return;const{widths:fe}=v.current,ge=s.current.getBoundingClientRect(),ue=de/ge.width*100,ve=fa(ue,F,B,ae,v.current,T.current);fe.some((ye,Re)=>ye!==ve[Re])&&m(ve)},e[18]=i,e[19]=k):k=e[19];const $=k;let A,D;e[20]!==i||e[21]!==d||e[22]!==u?(A=()=>{v.current.elements=i,v.current.panels=d,v.current.widths=u},D=[i,d,u],e[20]=i,e[21]=d,e[22]=u,e[23]=A,e[24]=D):(A=e[23],D=e[24]),f.useLayoutEffect(A,D);const M=ua();let W,U;e[25]!==d||e[26]!==M?(W=()=>{const{widths:V}=v.current;if(V.length===d.length)return;const H=M.get(d);if(H){const X=Zn(d,H,window.innerWidth);m(X);return}const F=va(d);m(F)},U=[M,d],e[25]=d,e[26]=M,e[27]=W,e[28]=U):(W=e[27],U=e[28]),f.useLayoutEffect(W,U);let K,G;e[29]!==d||e[30]!==M||e[31]!==u?(K=()=>{u.length&&M.setDebounced(d,u)},G=[M,d,u],e[29]=d,e[30]=M,e[31]=u,e[32]=K,e[33]=G):(K=e[32],G=e[33]),f.useEffect(K,G);let re,he;e[34]===Symbol.for("react.memo_cache_sentinel")?(re=()=>{const V=new ResizeObserver(()=>{const{panels:H,widths:F}=v.current,X=Zn(H,F,window.innerWidth);F.some((B,ae)=>B!==X[ae])&&m(X)});return V.observe(s.current),()=>{V.disconnect()}},he=[],e[34]=re,e[35]=he):(re=e[34],he=e[35]),f.useLayoutEffect(re,he);let ie,ce;e[36]!==h||e[37]!==$||e[38]!==_||e[39]!==P?(ce={activeResizer:h,drag:$,getPanelStyle:_,registerElement:w,startDragging:P,stopDragging:C,unregisterElement:R},e[36]=h,e[37]=$,e[38]=_,e[39]=P,e[40]=ce):ce=e[40],ie=ce;const le=ie;let ne;e[41]!==n?(ne=l.jsx(ya,{ref:s,children:n}),e[41]=n,e[42]=ne):ne=e[42];let me;return e[43]!==le||e[44]!==ne?(me=l.jsx(Nt.Provider,{value:le,children:ne}),e[43]=le,e[44]=ne,e[45]=me):me=e[45],me};function On(t){const e=z(37);let n,s,r,i,a;e[0]!==t?({children:n,message:s,onRetry:i,onContinueAnyway:r,...a}=t,e[0]=t,e[1]=n,e[2]=s,e[3]=r,e[4]=i,e[5]=a):(n=e[1],s=e[2],r=e[3],i=e[4],a=e[5]);const{t:o}=xe(we);let c;e[6]!==o?(c=o("error-card.retry-button.text"),e[6]=o,e[7]=c):c=e[7];let d;e[8]!==i||e[9]!==c?(d=l.jsx(be,{fontSize:1,mode:"ghost",onClick:i,text:c}),e[8]=i,e[9]=c,e[10]=d):d=e[10];const p=d;let u;e[11]!==o?(u=o("error-card.continue-button.text"),e[11]=o,e[12]=u):u=e[12];let m;e[13]!==r||e[14]!==u?(m=l.jsx(be,{fontSize:1,mode:"ghost",tone:"critical",onClick:r,text:u}),e[13]=r,e[14]=u,e[15]=m):m=e[15];const h=m;let b;e[16]!==o?(b=o("error-card.title"),e[16]=o,e[17]=b):b=e[17];let x;e[18]!==b?(x=l.jsx(q,{size:1,weight:"semibold",children:b}),e[18]=b,e[19]=x):x=e[19];let v;e[20]!==s?(v=l.jsx(q,{muted:!0,size:1,children:s}),e[20]=s,e[21]=v):v=e[21];let y;e[22]!==x||e[23]!==v?(y=l.jsxs(je,{space:3,children:[x,v]}),e[22]=x,e[23]=v,e[24]=y):y=e[24];let _;e[25]!==h||e[26]!==r||e[27]!==i||e[28]!==p?(_=i&&r?l.jsxs(ps,{space:2,children:[p,h]}):i?l.jsx(te,{children:p}):r?l.jsx(te,{children:h}):null,e[25]=h,e[26]=r,e[27]=i,e[28]=p,e[29]=_):_=e[29];let S;e[30]!==n||e[31]!==y||e[32]!==_?(S=l.jsx(J,{align:"center",height:"fill",justify:"center",children:l.jsx(hs,{padding:4,sizing:"border",width:0,children:l.jsxs(je,{space:4,children:[y,n,_]})})}),e[30]=n,e[31]=y,e[32]=_,e[33]=S):S=e[33];let w;return e[34]!==a||e[35]!==S?(w=l.jsx(oe,{height:"fill",...a,children:S}),e[34]=a,e[35]=S,e[36]=w):w=e[36],w}function xa(t={}){const e=Object.entries(t).map(([n,s])=>`${n}=${s}`).join("&");return e.length?`?${e}`:""}function wa(t){const e=["comment","inspect","instruction","pathKey","rev","since","template","view"],n=Object.entries(t).filter(([s])=>e.includes(s)).reduce((s,[r,i])=>i==null?s:{...s,[r]:i},{});return xa(n)}const _a=f.forwardRef(function(t,e){const n=z(11);let s,r;n[0]!==t?({searchParams:r,...s}=t,n[0]=t,n[1]=s,n[2]=r):(s=n[1],r=n[2]);let i;n[3]!==r?(i=Object.entries(r),n[3]=r,n[4]=i):i=n[4];let a;n[5]!==i?(a={type:void 0,_searchParams:i},n[5]=i,n[6]=a):a=n[6];let o;return n[7]!==e||n[8]!==s||n[9]!==a?(o=l.jsx(Lt,{...s,ref:e,state:a,title:void 0}),n[7]=e,n[8]=s,n[9]=a,n[10]=o):o=n[10],o}),Sa=f.forwardRef(function(t,e){const n=z(15);let s,r,i,a;if(n[0]!==t){const{documentId:p,documentType:u,parentRefPath:m,template:h,searchParams:b,...x}=t;s=p,r=u,a=b,i=x,n[0]=t,n[1]=s,n[2]=r,n[3]=i,n[4]=a}else s=n[1],r=n[2],i=n[3],a=n[4];let o;n[5]!==a?(o=Object.entries(a),n[5]=a,n[6]=o):o=n[6];let c;n[7]!==s||n[8]!==r||n[9]!==o?(c={id:s,type:r,_searchParams:o},n[7]=s,n[8]=r,n[9]=o,n[10]=c):c=n[10];let d;return n[11]!==e||n[12]!==i||n[13]!==c?(d=l.jsx(Lt,{...i,ref:e,state:c,title:void 0}),n[11]=e,n[12]=i,n[13]=c,n[14]=d):d=n[14],d});function Dr(t){const e=z(26),{children:n,onStructureParams:s,structureParams:r,searchParams:i,refs:a}=t,{state:o,resolvePathFromState:c}=yn();let d;e[0]!==o._searchParams?(d=Object.fromEntries(o._searchParams||[]),e[0]=o._searchParams,e[1]=d):d=e[1];const p=vr(d);let u;e[2]!==c||e[3]!==p||e[4]!==o?(u=T=>{const g=c(o),P=wa({...p,...T});return`${g}${P}`},e[2]=c,e[3]=p,e[4]=o,e[5]=u):u=e[5];const m=u;let h,b;e[6]===Symbol.for("react.memo_cache_sentinel")?(b={},e[6]=b):b=e[6];const x=r;let v;e[7]===Symbol.for("react.memo_cache_sentinel")?(v=[],e[7]=v):v=e[7];let y;e[8]!==a||e[9]!==i?(y=T=>{const{childId:g,...P}=T,I=a==null?void 0:a.find(C=>C._id===g||bn(C._id)===g);return I?l.jsx(Lt,{...P,state:{id:g,type:I._type,_searchParams:Object.entries(i)}}):l.jsx("div",{...P})},e[8]=a,e[9]=i,e[10]=y):y=e[10];let _,S;e[11]!==i?(_=T=>l.jsx(_a,{...T,searchParams:i}),S=T=>l.jsx(Sa,{...T,searchParams:i}),e[11]=i,e[12]=_,e[13]=S):(_=e[12],S=e[13]);let w;e[14]!==s?(w=T=>{s({...T,inspect:T.inspect??void 0})},e[14]=s,e[15]=w):w=e[15];let E;e[16]!==m||e[17]!==x||e[18]!==y||e[19]!==_||e[20]!==S||e[21]!==w?(E={index:0,groupIndex:0,siblingIndex:0,payload:b,params:x,hasGroupSiblings:!1,groupLength:1,routerPanesState:v,ChildLink:y,BackLink:_,ReferenceChildLink:S,ParameterizedLink:Aa,closeCurrentAndAfter:ka,handleEditReference:Ia,replaceCurrent:Ca,closeCurrent:Ta,duplicateCurrent:Ra,setView:Ea,setParams:w,setPayload:ja,navigateIntent:Pa,createPathWithParams:m},e[16]=m,e[17]=x,e[18]=y,e[19]=_,e[20]=S,e[21]=w,e[22]=E):E=e[22],h=E;const R=h;let j;return e[23]!==n||e[24]!==R?(j=l.jsx(Ys.Provider,{value:R,children:n}),e[23]=n,e[24]=R,e[25]=j):j=e[25],j}function Pa(t,e,n){console.warn("navigateIntent",t,e,n)}function ja(t){console.warn("setPayload",t)}function Ea(t){console.warn("setView",t)}function Ra(t){console.warn("duplicateCurrent",t)}function Ta(){console.warn("closeCurrent")}function Ca(t){console.warn("replaceCurrent",t)}function Ia(t){console.warn("handleEditReference",t)}function ka(){console.warn("closeCurrentAndAfter")}function Aa(){return l.jsx(l.Fragment,{children:"ParameterizedLink"})}const $a=pe(gr)`
  height: 100%;
`,Oa=pe(J)`
  & > div {
    min-width: none !important;
    max-width: none !important;
  }
`,Ma=pe($t)`
  white-space: pre-wrap;
`;function za(t){var g,P,I,C;const e=z(33),{mainDocumentState:n,onStructureParams:s,searchParams:r,refs:i}=t,{t:a}=xe(we),{devMode:o}=gn();let c,d;if(e[0]!==((g=n==null?void 0:n.document)==null?void 0:g._id)||e[1]!==i){let k;e[3]!==((P=n==null?void 0:n.document)==null?void 0:P._id)?(k=$=>{var A;return bn($._id)!==((A=n==null?void 0:n.document)==null?void 0:A._id)},e[3]=(I=n==null?void 0:n.document)==null?void 0:I._id,e[4]=k):k=e[4],d=i.filter(k).map(Da),e[0]=(C=n==null?void 0:n.document)==null?void 0:C._id,e[1]=i,e[2]=d}else d=e[2];c=d;const p=c;let u,m;e[5]!==p?(m={filter:"_id in $ids",params:{ids:p}},e[5]=p,e[6]=m):m=e[6];let h;e[7]!==a?(h=a("document-list-pane.document-list.title"),e[7]=a,e[8]=h):h=e[8];let b;e[9]!==m||e[10]!==h?(b={id:"$root",options:m,schemaTypeName:"",title:h,type:"documentList"},e[9]=m,e[10]=h,e[11]=b):b=e[11],u=b;const x=u,[v,y]=f.useState(null);let _;e[12]===Symbol.for("react.memo_cache_sentinel")?(_=()=>y(null),e[12]=_):_=e[12];const S=_,[w]=f.useState(La);let E;e[13]===Symbol.for("react.memo_cache_sentinel")?(E=()=>y(null),e[13]=E):E=e[13];let R;if(e[14]!==i?(R=[i],e[14]=i,e[15]=R):R=e[15],f.useEffect(E,R),v){let k;e[16]!==a?(k=a("document-list-pane.error.text"),e[16]=a,e[17]=k):k=e[17];let $;e[18]!==o||e[19]!==v||e[20]!==a?($=o&&l.jsx(oe,{overflow:"auto",padding:3,radius:2,tone:"critical",children:l.jsxs(je,{space:3,children:[l.jsx(At,{muted:!0,size:0,children:a("presentation-error.label")}),l.jsx(Ma,{size:1,children:v.error.message})]})}),e[18]=o,e[19]=v,e[20]=a,e[21]=$):$=e[21];let A;return e[22]!==$||e[23]!==k?(A=l.jsx(On,{flex:1,message:k,onRetry:S,children:$}),e[22]=$,e[23]=k,e[24]=A):A=e[24],A}let j;e[25]!==x?(j=l.jsx(Oa,{direction:"column",flex:1,children:l.jsx(Gs,{index:0,itemId:"$root",pane:x,paneKey:"$root"})}),e[25]=x,e[26]=j):j=e[26];let T;return e[27]!==s||e[28]!==i||e[29]!==r||e[30]!==w||e[31]!==j?(T=l.jsx(wr,{onCatch:y,children:l.jsx($a,{children:l.jsx(_r,{children:l.jsx(Dr,{onStructureParams:s,structureParams:w,searchParams:r,refs:i,children:j})})})}),e[27]=s,e[28]=i,e[29]=r,e[30]=w,e[31]=j,e[32]=T):T=e[32],T}function La(){return{}}function Da(t){return t._id}const Ua=pe($t)`
  white-space: pre-wrap;
`;function Wa(t){const e=z(35),{documentId:n,documentType:s,onFocusPath:r,onStructureParams:i,searchParams:a,structureParams:o}=t,{template:c,templateParams:d}=o,{t:p}=xe(we),{devMode:u}=gn();let m,h;e[0]!==d?(h=Zs(d),e[0]=d,e[1]=h):h=e[1];let b;e[2]!==n||e[3]!==s||e[4]!==h||e[5]!==c?(b={id:n,type:s,template:c,templateParameters:h},e[2]=n,e[3]=s,e[4]=h,e[5]=c,e[6]=b):b=e[6];let x;e[7]!==n||e[8]!==b?(x={id:n,options:b,title:"",type:"document"},e[7]=n,e[8]=b,e[9]=x):x=e[9],m=x;const v=m,[y,_]=f.useState(null);let S;e[10]===Symbol.for("react.memo_cache_sentinel")?(S=()=>_(null),e[10]=S):S=e[10];const w=S;let E;e[11]===Symbol.for("react.memo_cache_sentinel")?(E=()=>{_(null)},e[11]=E):E=e[11];let R;if(e[12]!==n||e[13]!==s||e[14]!==o?(R=[n,s,o],e[12]=n,e[13]=s,e[14]=o,e[15]=R):R=e[15],f.useEffect(E,R),y){let I;e[16]!==p?(I=p("document-pane.error.text"),e[16]=p,e[17]=I):I=e[17];let C;e[18]!==u||e[19]!==y||e[20]!==p?(C=u&&l.jsx(oe,{overflow:"auto",padding:3,radius:2,tone:"critical",children:l.jsxs(je,{space:3,children:[l.jsx(At,{muted:!0,size:0,children:p("presentation-error.label")}),l.jsx(Ua,{size:1,children:y.error.message})]})}),e[18]=u,e[19]=y,e[20]=p,e[21]=C):C=e[21];let k;return e[22]!==I||e[23]!==C?(k=l.jsx(On,{flex:1,message:I,onRetry:w,children:C}),e[22]=I,e[23]=C,e[24]=k):k=e[24],k}let j;e[25]===Symbol.for("react.memo_cache_sentinel")?(j={height:"100%"},e[25]=j):j=e[25];let T;e[26]===Symbol.for("react.memo_cache_sentinel")?(T=l.jsx(yr,{}),e[26]=T):T=e[26];let g;e[27]!==r||e[28]!==v?(g=l.jsx(f.Suspense,{fallback:T,children:l.jsx(ei,{paneKey:"document",index:1,itemId:"document",pane:v,onFocusPath:r})}),e[27]=r,e[28]=v,e[29]=g):g=e[29];let P;return e[30]!==i||e[31]!==a||e[32]!==o||e[33]!==g?(P=l.jsx(wr,{onCatch:_,children:l.jsx(gr,{style:j,children:l.jsx(Dr,{searchParams:a,onStructureParams:i,structureParams:o,children:g})})}),e[30]=i,e[31]=a,e[32]=o,e[33]=g,e[34]=P):P=e[34],P}function Na(t){const e=z(7),{documentId:n,documentType:s,onFocusPath:r,onStructureParams:i,searchParams:a,structureParams:o}=t;let c;return e[0]!==n||e[1]!==s||e[2]!==r||e[3]!==i||e[4]!==a||e[5]!==o?(c=l.jsx(_r,{children:l.jsx(Wa,{documentId:n,documentType:s,onFocusPath:r,onStructureParams:i,searchParams:a,structureParams:o})}),e[0]=n,e[1]=s,e[2]=r,e[3]=i,e[4]=a,e[5]=o,e[6]=c):c=e[6],c}function qa(t,e){const n=z(6),s=Us();let r;n[0]===Symbol.for("react.memo_cache_sentinel")?(r={},n[0]=r):r=n[0];const[i,a]=f.useState(r);let o,c;return n[1]!==t||n[2]!==s||n[3]!==e?(o=()=>{if(!e)return;const d=Bs(s,e,t,"").subscribe(p=>{a(p)});return()=>{d==null||d.unsubscribe()}},c=[s,e,t],n[1]=t,n[2]=s,n[3]=e,n[4]=o,n[5]=c):(o=n[4],c=n[5]),f.useEffect(o,c),i}function Va(t){var j,T,g,P,I,C,k,$;const e=z(39),{documentId:n,documentType:s,mainDocumentState:r,onFocusPath:i,onStructureParams:a,refs:o,searchParams:c,structureParams:d}=t,{t:p}=xe(we),u=ks();let m;e[0]!==((j=r==null?void 0:r.document)==null?void 0:j._id)||e[1]!==((T=r==null?void 0:r.document)==null?void 0:T._type)||e[2]!==c?(m=A=>{var D,M;return l.jsx(Lt,{...A,state:{id:(D=r==null?void 0:r.document)==null?void 0:D._id,type:(M=r==null?void 0:r.document)==null?void 0:M._type,_searchParams:Object.entries(c)}})},e[0]=(g=r==null?void 0:r.document)==null?void 0:g._id,e[1]=(P=r==null?void 0:r.document)==null?void 0:P._type,e[2]=c,e[3]=m):m=e[3];const h=m;let b,x;e[4]!==((I=r==null?void 0:r.document)==null?void 0:I._type)||e[5]!==u?(x=u.get(((C=r==null?void 0:r.document)==null?void 0:C._type)||"shoe"),e[4]=(k=r==null?void 0:r.document)==null?void 0:k._type,e[5]=u,e[6]=x):x=e[6],b=x;const v=b,y=qa((($=r==null?void 0:r.document)==null?void 0:$._id)||"",v);let _;e:{if(!(r!=null&&r.document)){_=null;break e}const A=r.document;let D;e[7]!==y.draft||e[8]!==y.published||e[9]!==A?(D=As({value:A,published:y.published,draft:y.draft}),e[7]=y.draft,e[8]=y.published,e[9]=A,e[10]=D):D=e[10];let M;e[11]!==p?(M=p("main-document.label"),e[11]=p,e[12]=M):M=e[12];let W;e[13]!==M?(W=l.jsx(oe,{padding:1,radius:2,shadow:1,children:l.jsx(q,{muted:!0,size:0,weight:"medium",children:M})}),e[13]=M,e[14]=W):W=e[14];let U;e[15]!==v||e[16]!==D||e[17]!==W?(U=l.jsx($s,{...D,schemaType:v,status:W}),e[15]=v,e[16]=D,e[17]=W,e[18]=U):U=e[18],_=U}const S=_;if(n&&s){let A;return e[19]!==n||e[20]!==s||e[21]!==i||e[22]!==a||e[23]!==c||e[24]!==d?(A=l.jsx(Na,{documentId:n,documentType:s,onFocusPath:i,onStructureParams:a,searchParams:c,structureParams:d}),e[19]=n,e[20]=s,e[21]=i,e[22]=a,e[23]=c,e[24]=d,e[25]=A):A=e[25],A}let w;e[26]!==h||e[27]!==r||e[28]!==S||e[29]!==p?(w=r&&l.jsx(oe,{padding:3,tone:r.document?"inherit":"caution",children:r.document?l.jsx(Os,{__unstable_focusRing:!0,as:h,"data-as":"a",radius:2,sizing:"border",tone:"inherit",children:S}):l.jsx(oe,{padding:2,radius:2,tone:"inherit",children:l.jsxs(J,{gap:3,children:[l.jsx(te,{flex:"none",children:l.jsx(q,{size:1,children:l.jsx(Ms,{})})}),l.jsx(te,{flex:1,children:l.jsx(q,{size:1,children:l.jsx(zs,{t:p,i18nKey:"main-document.missing.text",components:{Code:"code"},values:{path:r.path}})})})]})})}),e[26]=h,e[27]=r,e[28]=S,e[29]=p,e[30]=w):w=e[30];let E;e[31]!==r||e[32]!==a||e[33]!==o||e[34]!==c?(E=l.jsx(za,{mainDocumentState:r,onStructureParams:a,searchParams:c,refs:o}),e[31]=r,e[32]=a,e[33]=o,e[34]=c,e[35]=E):E=e[35];let R;return e[36]!==w||e[37]!==E?(R=l.jsxs(J,{direction:"column",flex:1,height:"fill",children:[w,E]}),e[36]=w,e[37]=E,e[38]=R):R=e[38],R}var ee=[];for(var en=0;en<256;++en)ee.push((en+256).toString(16).slice(1));function Fa(t,e=0){return(ee[t[e+0]]+ee[t[e+1]]+ee[t[e+2]]+ee[t[e+3]]+"-"+ee[t[e+4]]+ee[t[e+5]]+"-"+ee[t[e+6]]+ee[t[e+7]]+"-"+ee[t[e+8]]+ee[t[e+9]]+"-"+ee[t[e+10]]+ee[t[e+11]]+ee[t[e+12]]+ee[t[e+13]]+ee[t[e+14]]+ee[t[e+15]]).toLowerCase()}var Ct,Ka=new Uint8Array(16);function Ha(){if(!Ct&&(Ct=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Ct))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Ct(Ka)}var Ba=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),er={randomUUID:Ba};function Ga(t,e,n){if(er.randomUUID&&!e&&!t)return er.randomUUID();t=t||{};var s=t.random||(t.rng||Ha)();return s[6]=s[6]&15|64,s[8]=s[8]&63|128,Fa(s)}function Xa(t){const e=z(2);let n;e[0]!==t?(n=()=>t||Ga(),e[0]=t,e[1]=n):n=e[1];const[s]=f.useState(n);return s}const Ja=pe.div`
  position: relative;
`,Qa=pe.div`
  position: absolute;
  top: 0;
  bottom: 0;
  left: -5px;
  width: 9px;
  z-index: 10;
  cursor: ${({$disabled:t})=>t?"auto":"ew-resize"};

  /* Border */
  & > span:nth-child(1) {
    display: block;
    border-left: 1px solid var(--card-border-color);
    position: absolute;
    top: 0;
    left: 4px;
    bottom: 0;
    transition: opacity 200ms;
  }

  ${({$disabled:t})=>!t&&`
    /* Hover effect */
    & > span:nth-child(2) {
      display: block;
      position: absolute;
      top: 0;
      left: 0;
      width: 9px;
      bottom: 0;
      background-color: var(--card-border-color);
      opacity: 0;
      transition: opacity 150ms;
    }

    @media (hover: hover) {
      &:hover > span:nth-child(2) {
        opacity: 0.2;
      }
    }
  `}
`,Ur=function(t){const e=z(27),{id:n,order:s,disabled:r}=t,i=r===void 0?!1:r,a=f.useRef(null),o=f.useContext(Nt);if(o===null)throw Error("Panel components must be rendered within a PanelGroup container");const c=Xa(n),{activeResizer:d,drag:p,startDragging:u,stopDragging:m,registerElement:h,unregisterElement:b}=o,x=d===c;if(o===null)throw Error("Panel components must be rendered within a PanelGroup container");let v;e[0]!==c||e[1]!==u?(v=$=>{u(c,$.nativeEvent)},e[0]=c,e[1]=u,e[2]=v):v=e[2];const y=v;let _;e[3]!==p||e[4]!==c?(_=$=>{p(c,$)},e[3]=p,e[4]=c,e[5]=_):_=e[5];const S=_;let w;e[6]!==m?(w=()=>{a.current.blur(),m()},e[6]=m,e[7]=w):w=e[7];const E=w;let R,j;e[8]!==i||e[9]!==x||e[10]!==S||e[11]!==E?(R=()=>{if(!x||i)return;const $=function(){const A=document.body.style,D=document.documentElement.style,{cursor:M}=D,{userSelect:W}=A;return D.cursor="ew-resize",A.userSelect="none",()=>{M?D.cursor=M:D.removeProperty("cursor"),W?A.userSelect=W:A.removeProperty("user-select")}}();return window.addEventListener("mousemove",S),window.addEventListener("mouseup",E),window.addEventListener("contextmenu",E),()=>{$(),window.removeEventListener("mousemove",S),window.removeEventListener("mouseup",E),window.removeEventListener("contextmenu",E)}},j=[i,x,S,E],e[8]=i,e[9]=x,e[10]=S,e[11]=E,e[12]=R,e[13]=j):(R=e[12],j=e[13]),f.useEffect(R,j);let T,g;e[14]!==c||e[15]!==s||e[16]!==h||e[17]!==b?(T=()=>(h(c,{id:c,order:s,type:"resizer",el:a}),()=>{b(c)}),g=[c,s,h,b],e[14]=c,e[15]=s,e[16]=h,e[17]=b,e[18]=T,e[19]=g):(T=e[18],g=e[19]),f.useLayoutEffect(T,g);let P,I;e[20]===Symbol.for("react.memo_cache_sentinel")?(I=l.jsx("span",{}),P=l.jsx("span",{}),e[20]=P,e[21]=I):(P=e[20],I=e[21]);let C;e[22]!==i?(C=l.jsxs(Qa,{$disabled:i,children:[I,P]}),e[22]=i,e[23]=C):C=e[23];let k;return e[24]!==y||e[25]!==C?(k=l.jsx(Ja,{onMouseDown:y,ref:a,children:C}),e[24]=y,e[25]=C,e[26]=k):k=e[26],k},Ya=t=>{const e=z(8),{documentId:n,setDisplayedDocument:s,getCommentIntent:r}=t;let i;e[0]===Symbol.for("react.memo_cache_sentinel")?(i=l.jsx(Ur,{order:4}),e[0]=i):i=e[0];let a;e[1]!==r||e[2]!==t.children?(a=l.jsx(Ls,{getIntent:r,children:t.children}),e[1]=r,e[2]=t.children,e[3]=a):a=e[3];let o;return e[4]!==n||e[5]!==s||e[6]!==a?(o=l.jsxs(l.Fragment,{children:[i,l.jsx($n,{id:"content",minWidth:325,order:5,children:l.jsx(ni,{documentId:n,setDisplayedDocument:s,children:a})})]}),e[4]=n,e[5]=s,e[6]=a,e[7]=o):o=e[7],o},Za=t=>{const e=z(14),{documentId:n,documentsOnPage:s,documentType:r,getCommentIntent:i,mainDocumentState:a,onFocusPath:o,onStructureParams:c,searchParams:d,setDisplayedDocument:p,structureParams:u}=t;let m;e[0]!==n||e[1]!==r||e[2]!==s||e[3]!==a||e[4]!==o||e[5]!==c||e[6]!==d||e[7]!==u?(m=l.jsx(Va,{documentId:n,documentType:r,mainDocumentState:a,onFocusPath:o,onStructureParams:c,refs:s,searchParams:d,structureParams:u}),e[0]=n,e[1]=r,e[2]=s,e[3]=a,e[4]=o,e[5]=c,e[6]=d,e[7]=u,e[8]=m):m=e[8];let h;return e[9]!==n||e[10]!==i||e[11]!==p||e[12]!==m?(h=l.jsx(Ya,{documentId:n,getCommentIntent:i,setDisplayedDocument:p,children:m}),e[9]=n,e[10]=i,e[11]=p,e[12]=m,e[13]=h):h=e[13],h},eo=function(t){const e=z(5),{children:n,navigate:s}=t;let r;e[0]!==s?(r=(o,c)=>{s((c===void 0?void 0:c)||{},o?{preview:o}:{})},e[0]=s,e[1]=r):r=e[1];const i=r;let a;return e[2]!==n||e[3]!==i?(a=l.jsx(Es.Provider,{value:i,children:n}),e[2]=n,e[3]=i,e[4]=a):a=e[4],a};function to(t,e){const n=z(9);let s;n[0]!==e||n[1]!==t?(s=()=>JSON.parse(localStorage.getItem(t)??JSON.stringify(e)),n[0]=e,n[1]=t,n[2]=s):s=n[2];const[r,i]=f.useState(s);let a,o;n[3]!==t||n[4]!==r?(a=()=>{localStorage.setItem(t,JSON.stringify(r))},o=[t,r],n[3]=t,n[4]=r,n[5]=a,n[6]=o):(a=n[5],o=n[6]),f.useEffect(a,o);let c;return n[7]!==r?(c=[r,i],n[7]=r,n[8]=c):c=n[8],c}function no(t){const e=z(11),{unstable_navigator:n}=t,s=!!(n!=null&&n.component),[r,i]=to("presentation/navigator",s),a=s?r:!1;let o;e:{if(!s){o=void 0;break e}let h;e[0]!==i?(h=()=>i(ro),e[0]=i,e[1]=h):h=e[1],o=h}const c=o;let d;e[2]!==a||e[3]!==n?(d=function(){return l.jsx(l.Fragment,{children:a&&l.jsx(io,{...n})})},e[2]=a,e[3]=n,e[4]=d):d=e[4];const p=d;let u;e[5]!==a||e[6]!==c?(u={navigatorEnabled:a,toggleNavigator:c},e[5]=a,e[6]=c,e[7]=u):u=e[7];let m;return e[8]!==p||e[9]!==u?(m=[u,p],e[8]=p,e[9]=u,e[10]=m):m=e[10],m}function ro(t){return!t}function so(t){const e=z(11),{minWidth:n,maxWidth:s,component:r}=t,i=n!=null&&s!=null&&n===s;let a;e[0]!==r?(a=l.jsx(r,{}),e[0]=r,e[1]=a):a=e[1];let o;e[2]!==s||e[3]!==n||e[4]!==a?(o=l.jsx($n,{id:"navigator",minWidth:n,maxWidth:s,order:1,children:a}),e[2]=s,e[3]=n,e[4]=a,e[5]=o):o=e[5];let c;e[6]!==i?(c=l.jsx(Ur,{order:2,disabled:i}),e[6]=i,e[7]=c):c=e[7];let d;return e[8]!==o||e[9]!==c?(d=l.jsxs(l.Fragment,{children:[o,c]}),e[8]=o,e[9]=c,e[10]=d):d=e[10],d}const io=f.memo(so),ao=function(t){const e=z(3),{children:n,params:s}=t;let r;r=s;const i=r;let a;return e[0]!==n||e[1]!==i?(a=l.jsx(Rs.Provider,{value:i,children:n}),e[0]=n,e[1]=i,e[2]=a):a=e[2],a},oo=function(t){const e=z(10),{children:n,devMode:s,name:r,navigate:i,params:a,searchParams:o,structureParams:c}=t;let d,p;e[0]!==s||e[1]!==r||e[2]!==i||e[3]!==a||e[4]!==o||e[5]!==c?(p={devMode:s,name:r,navigate:i,params:a,searchParams:o,structureParams:c},e[0]=s,e[1]=r,e[2]=i,e[3]=a,e[4]=o,e[5]=c,e[6]=p):p=e[6],d=p;const u=d;let m;return e[7]!==n||e[8]!==u?(m=l.jsx(Ts.Provider,{value:u,children:n}),e[7]=n,e[8]=u,e[9]=m):m=e[9],m},co=bt(pe.iframe`
  box-shadow: 0 0 0 1px var(--card-border-color);
  border: 0;
  max-height: 100%;
  width: 100%;
  view-transition-class: presentation-tool-iframe;
`),lo=pe(te)`
  position: absolute;
  inset: 0;
  background: transparent;
`,uo=f.forwardRef(function(t,e){const n=z(16),{animate:s,initial:r,onLoad:i,preventClick:a,src:o,variants:c,style:d}=t,p=`presentation-tool-iframe-${f.useId().replace(/[^a-zA-Z0-9-_]/g,"_")}`;let u;n[0]!==d||n[1]!==p?(u={...d,viewTransitionName:p},n[0]=d,n[1]=p,n[2]=u):u=n[2];let m;n[3]!==s||n[4]!==r||n[5]!==i||n[6]!==e||n[7]!==o||n[8]!==u||n[9]!==c?(m=l.jsx(co,{style:u,animate:s,initial:r,onLoad:i,ref:e,src:o,variants:c}),n[3]=s,n[4]=r,n[5]=i,n[6]=e,n[7]=o,n[8]=u,n[9]=c,n[10]=m):m=n[10];let h;n[11]!==a?(h=a&&l.jsx(lo,{}),n[11]=a,n[12]=h):h=n[12];let b;return n[13]!==m||n[14]!==h?(b=l.jsxs(l.Fragment,{children:[m,h]}),n[13]=m,n[14]=h,n[15]=b):b=n[15],b});function po(t){const e=z(16),{openPopup:n,previewLocationOrigin:s,previewLocationRoute:r}=t,{t:i}=xe(we);let a;e[0]!==n?(a=x=>{x.preventDefault(),n(x.currentTarget.href)},e[0]=n,e[1]=a):a=e[1];const o=a;let c;e[2]!==i?(c=i("share-url.menu-item.open.text"),e[2]=i,e[3]=c):c=e[3];let d;e[4]!==c?(d=l.jsx(q,{size:1,children:c}),e[4]=c,e[5]=d):d=e[5];let p;e[6]===Symbol.for("react.memo_cache_sentinel")?(p=["bottom-start"],e[6]=p):p=e[6];let u;e[7]!==i?(u=i("share-url.menu-item.open.text"),e[7]=i,e[8]=u):u=e[8];const m=`${s}${r}`;let h;e[9]!==o||e[10]!==u||e[11]!==m?(h=l.jsx(be,{as:"a","aria-label":u,fontSize:1,icon:Xs,mode:"bleed",padding:2,href:m,onClick:o,rel:"opener",target:"_blank"}),e[9]=o,e[10]=u,e[11]=m,e[12]=h):h=e[12];let b;return e[13]!==d||e[14]!==h?(b=l.jsx(dt,{animate:!0,content:d,fallbackPlacements:p,padding:2,placement:"bottom",portal:!0,children:h}),e[13]=d,e[14]=h,e[15]=b):b=e[15],b}const ho=function(t){var W;const e=z(27),{fontSize:n,onChange:s,origin:r,padding:i,prefix:a,suffix:o,value:c}=t,d=n===void 0?1:n,p=i===void 0?3:i,{t:u}=xe(we),{basePath:m}=((W=xr())==null?void 0:W.activeWorkspace)||{},h=m===void 0?"/":m,b=f.useRef(null),[x,v]=f.useState(void 0),[y,_]=f.useState(void 0);let S;e[0]===Symbol.for("react.memo_cache_sentinel")?(S=U=>{v(U.currentTarget.value)},e[0]=S):S=e[0];const w=S;let E;e[1]!==h||e[2]!==s||e[3]!==r||e[4]!==x||e[5]!==u?(E=U=>{var K;if(U.key==="Enter"){if(x===void 0)return;const G=x.startsWith("/")||x===""?`${r}${x}`:x;if(!G.startsWith(r+"/")&&G!==r){_(u("preview-location-input.error",{origin:r,context:"missing-origin"}));return}if(!r&&(G.startsWith(`${h}/`)||G===h)){_(u("preview-location-input.error",{basePath:h,context:"same-base-path"}));return}const re=G===r?r+"/":G;_(void 0),v(void 0),s(re.slice(r.length)),(K=b.current)==null||K.blur()}U.key==="Escape"&&(_(void 0),v(void 0))},e[1]=h,e[2]=s,e[3]=r,e[4]=x,e[5]=u,e[6]=E):E=e[6];const R=E;let j;e[7]===Symbol.for("react.memo_cache_sentinel")?(j=()=>{_(void 0),v(void 0)},e[7]=j):j=e[7];const T=j;let g;e[8]===Symbol.for("react.memo_cache_sentinel")?(g=()=>{_(void 0),v(void 0)},e[8]=g):g=e[8];let P;e[9]!==r||e[10]!==c?(P=[r,c],e[9]=r,e[10]=c,e[11]=P):P=e[11],f.useEffect(g,P);let I,C;e[12]===Symbol.for("react.memo_cache_sentinel")?(C={icon:Js},e[12]=C):C=e[12],I=C;const k=y?I:void 0;let $;e[13]!==r||e[14]!==c?($=()=>{_(void 0),v(r+c)},e[13]=r,e[14]=c,e[15]=$):$=e[15];let A;e[16]===Symbol.for("react.memo_cache_sentinel")?(A={zIndex:1},e[16]=A):A=e[16];const D=x===void 0?`${r}${c}`:x;let M;return e[17]!==y||e[18]!==d||e[19]!==R||e[20]!==p||e[21]!==a||e[22]!==o||e[23]!==k||e[24]!==$||e[25]!==D?(M=l.jsx(l.Fragment,{children:l.jsx(Qs,{clearButton:k,customValidity:y,fontSize:d,onBlur:T,onClear:$,onChange:w,onKeyDownCapture:R,padding:p,prefix:a,style:A,radius:2,ref:b,space:p,suffix:o,value:D})}),e[17]=y,e[18]=d,e[19]=R,e[20]=p,e[21]=a,e[22]=o,e[23]=k,e[24]=$,e[25]=D,e[26]=M):M=e[26],M},mo=f.lazy(()=>Ee(()=>import("./QRCodeSVG-740f2461.js"),["static/QRCodeSVG-740f2461.js","static/sanity-05ba3066.js"])),pn=24,fo=16,go=224,vo=pe(ms)`
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  height: ${pn}px;
  width: ${pn}px;
`,yo=bt(kt),bo=bt(q),xo=bt(vo),Wr=f.memo(function(t){const{canToggleSharePreviewAccess:e,canUseSharedPreviewAccess:n,initialUrl:s,previewLocationRoute:r,perspective:i}=t,{t:a}=xe(we),{push:o}=lr(),c=Dt({apiVersion:Ut}),d=fn(),[p,u]=f.useState(!0),[m,h]=f.useState(!1),[b,x]=f.useState(!1),[v,y]=f.useState(null),_=m||b||p,S=f.useMemo(()=>v?Oi(s,v,r,i):null,[s,i,r,v]),[w,E]=f.useState(null);if(w)throw w;const R=f.useCallback(()=>{o({closable:!0,status:"warning",title:a("share-preview-menu.error_toggle-sharing",{context:"toggle-sharing"})})},[o,a]),j=f.useCallback(async()=>{try{x(!0),await zi(c,"@sanity/presentation",typeof window>"u"?"":location.href,d==null?void 0:d.id),y(null)}catch(P){E(P)}finally{x(!1)}},[c,d==null?void 0:d.id]),T=f.useCallback(async()=>{try{h(!0);const P=await Mi(c,"@sanity/presentation",typeof window>"u"?"":location.href,d==null?void 0:d.id);y(P.secret)}catch(P){E(P)}finally{h(!1)}},[c,d==null?void 0:d.id]),g=f.useCallback(()=>{try{if(!S)throw new Error("No URL to copy");navigator.clipboard.writeText(S.toString()),o({closable:!0,status:"success",title:a("share-url.clipboard.status",{context:"success"})})}catch(P){E(P)}},[o,a,S]);return f.useEffect(()=>{let P=new AbortController,I=[];async function C($,A){const{result:D,syncTags:M}=await c.fetch(oi,{},{filterResponse:!1,lastLiveEventId:$,tag:"presentation.fetch-shared-access-secret"});Array.isArray(M)&&(I=M),A.aborted||y(D)}const k=c.live.events().subscribe({next:$=>{$.type==="message"&&(P.abort(),P=new AbortController,$.tags.some(A=>I.includes(A))&&C($.id,P.signal))},error:E});return C(null,P.signal).finally(()=>u(!1)),()=>{k.unsubscribe(),P.abort()}},[c]),l.jsx(dr,{button:l.jsx(be,{"aria-label":a("preview-frame.share-button.aria-label"),fontSize:1,icon:ts,mode:"bleed",padding:2}),id:"share-menu",menu:l.jsx(ur,{style:{maxWidth:248},padding:n?void 0:0,children:n?l.jsxs(l.Fragment,{children:[l.jsx("label",{style:{cursor:"pointer"},children:l.jsxs(ns,{columns:2,rows:2,gapX:3,gapY:1,style:{justifyContent:"center",alignItems:"center",gridTemplateColumns:"min-content 1fr",gridTemplateRows:"min-content"},paddingTop:3,paddingX:3,children:[l.jsx(dt,{animate:!0,content:l.jsx(q,{size:1,children:a("share-preview-menu.toggle-button.tooltip",{context:S?"disable":"enable"})}),fallbackPlacements:["bottom-start"],padding:1,placement:"bottom",portal:!0,children:l.jsx(pr,{checked:m||S!==null&&!b,readOnly:m||b,indeterminate:p,onChange:e?S?j:T:R})}),l.jsx(q,{size:1,weight:"medium",children:a("share-preview-menu.toggle-button.label",{context:"first-line"})}),l.jsx("span",{}),l.jsx(q,{muted:!0,size:1,children:a("share-preview-menu.toggle-button.label",{context:"second-line"})})]})}),l.jsx(te,{padding:3,paddingTop:2,children:l.jsxs(je,{space:3,children:[l.jsx(oe,{tone:_||!S?"transparent":void 0,style:{position:"relative",aspectRatio:"1 / 1",display:"flex",alignItems:"center",justifyContent:"center"},children:l.jsx(hr,{children:_?l.jsx(yo,{muted:!0,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0}}):S?l.jsx(l.Fragment,{children:l.jsxs(f.Suspense,{fallback:l.jsx(kt,{}),children:[l.jsx(mo,{title:a("share-preview-menu.qr-code.title",{url:S.toString()}),value:S.toString(),size:go,color:"var(--card-fg-color)",logoSize:pn+fo}),l.jsx(xo,{initial:{opacity:-.5},animate:{opacity:1.5},exit:{opacity:0}})]})}):l.jsx(bo,{muted:!0,size:1,style:{maxWidth:"100px",textWrap:"pretty",textAlign:"center"},initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:a("share-preview-menu.qr-code.placeholder")})})}),l.jsx(q,{muted:!0,size:1,children:a("share-preview-menu.qr-code.instructions")})]})}),l.jsx(rs,{}),l.jsx(ln,{disabled:!S||b,icon:ss,onClick:g,fontSize:1,padding:3,text:a("share-preview-menu.copy-url.text")})]}):l.jsx(oe,{padding:2,tone:"caution",radius:3,children:l.jsx(q,{style:{textWrap:"pretty"},children:a("share-preview-menu.error",{context:"missing-grants"})})})}),popover:{animate:!0,constrainSize:!0,placement:"bottom",portal:!0}})});Wr.displayName="Memo(SharePreviewMenu)";const tn={previewDrafts:"preview-frame.perspective.previewDrafts.title",published:"preview-frame.perspective.published.title"},tr={previewDrafts:"caution",published:"positive"},nr={previewDrafts:Ws,published:Ns},wo=t=>{const e=z(164),{canSharePreviewAccess:n,canToggleSharePreviewAccess:s,canUseSharedPreviewAccess:r,dispatch:i,iframe:a,iframeRef:o,initialUrl:c,loadersConnection:d,navigatorEnabled:p,onPathChange:u,onRefresh:m,openPopup:h,overlaysConnection:b,perspective:x,previewUrl:v,setPerspective:y,setViewport:_,targetOrigin:S,toggleNavigator:w,toggleOverlay:E,viewport:R,visualEditing:j}=t,{overlaysEnabled:T}=j,{t:g}=xe(we);let P;e[0]!==_||e[1]!==R?(P=()=>_(R==="desktop"?"mobile":"desktop"),e[0]=_,e[1]=R,e[2]=P):P=e[2];const I=P;let C;C=S===location.origin?"":S;const k=C;let $;e[3]!==i||e[4]!==o.current||e[5]!==m||e[6]!==v||e[7]!==S?($=()=>{m(()=>{o.current&&(i({type:mr}),Object.assign(o.current,{src:`${S}${v||"/"}`}))})},e[3]=i,e[4]=o.current,e[5]=m,e[6]=v,e[7]=S,e[8]=$):$=e[8];const A=$;let D;const M=new URL(v||"/",S),{pathname:W,search:U}=$i(M);D=`${W}${U}`;const K=D;let G;e[9]!==p||e[10]!==g||e[11]!==w?(G=w&&l.jsx(te,{flex:"none",marginRight:1,padding:1,children:l.jsx(dt,{animate:!0,content:l.jsx(q,{size:1,children:g("preview-frame.navigator.toggle-button.tooltip")}),fallbackPlacements:["bottom-start"],padding:2,placement:"bottom",portal:!0,children:l.jsx(be,{"aria-label":g("preview-frame.navigator.toggle-button.aria-label"),fontSize:1,icon:Ds,mode:"bleed",onClick:w,padding:2,selected:p})})}),e[9]=p,e[10]=g,e[11]=w,e[12]=G):G=e[12];let re;e[13]===Symbol.for("react.memo_cache_sentinel")?(re={whiteSpace:"nowrap"},e[13]=re):re=e[13];const he=T?"disable":"enable";let ie;e[14]!==g||e[15]!==he?(ie=g("preview-frame.overlay.toggle-button.tooltip",{context:he}),e[14]=g,e[15]=he,e[16]=ie):ie=e[16];let ce;e[17]!==ie?(ce=l.jsx(te,{padding:1,children:l.jsx(q,{size:1,children:ie})}),e[17]=ie,e[18]=ce):ce=e[18];let le;e[19]===Symbol.for("react.memo_cache_sentinel")?(le=l.jsx(te,{paddingY:1,children:l.jsx(qs,{keys:["Alt"],style:{marginTop:-4,marginBottom:-4}})}),e[19]=le):le=e[19];let ne;e[20]!==ce?(ne=l.jsxs(J,{align:"center",style:re,children:[ce,le]}),e[20]=ce,e[21]=ne):ne=e[21];let me;e[22]===Symbol.for("react.memo_cache_sentinel")?(me=["bottom-start"],e[22]=me):me=e[22];let V;e[23]===Symbol.for("react.memo_cache_sentinel")?(V={lineHeight:0,borderRadius:999,userSelect:"none"},e[23]=V):V=e[23];const H=T?"transparent":void 0;let F;e[24]===Symbol.for("react.memo_cache_sentinel")?(F={margin:-4},e[24]=F):F=e[24];const X=a.status==="loading"||b!=="connected";let B;e[25]!==T||e[26]!==X||e[27]!==E?(B=l.jsx("div",{style:F,children:l.jsx(pr,{checked:T,onChange:E,disabled:X})}),e[25]=T,e[26]=X,e[27]=E,e[28]=B):B=e[28];const ae=!T;let Y;e[29]!==g?(Y=g("preview-frame.overlay.toggle-button.text"),e[29]=g,e[30]=Y):Y=e[30];let Q;e[31]!==ae||e[32]!==Y?(Q=l.jsx(te,{children:l.jsx(q,{muted:ae,size:1,weight:"medium",children:Y})}),e[31]=ae,e[32]=Y,e[33]=Q):Q=e[33];let se;e[34]!==B||e[35]!==Q?(se=l.jsxs(J,{align:"center",gap:3,children:[B,Q]}),e[34]=B,e[35]=Q,e[36]=se):se=e[36];let de;e[37]!==H||e[38]!==se?(de=l.jsx(oe,{as:"label",flex:"none",marginRight:1,padding:3,style:V,tone:H,children:se}),e[37]=H,e[38]=se,e[39]=de):de=e[39];let fe;e[40]!==ne||e[41]!==de?(fe=l.jsx(dt,{animate:!0,content:ne,fallbackPlacements:me,padding:1,placement:"bottom",portal:!0,children:de}),e[40]=ne,e[41]=de,e[42]=fe):fe=e[42];let ge;e[43]!==a.status||e[44]!==g?(ge=a.status==="loaded"?g("preview-frame.refresh-button.tooltip"):g("preview-frame.status",{context:a.status}),e[43]=a.status,e[44]=g,e[45]=ge):ge=e[45];let ue;e[46]!==ge?(ue=l.jsx(q,{size:1,children:ge}),e[46]=ge,e[47]=ue):ue=e[47];let ve;e[48]===Symbol.for("react.memo_cache_sentinel")?(ve=["bottom-end"],e[48]=ve):ve=e[48];let ye;e[49]!==g?(ye=g("preview-frame.refresh-button.aria-label"),e[49]=g,e[50]=ye):ye=e[50];const Re=a.status==="reloading"||a.status==="refreshing";let Te;e[51]!==A||e[52]!==ye||e[53]!==Re?(Te=l.jsx(be,{"aria-label":ye,fontSize:1,icon:Vs,mode:"bleed",loading:Re,onClick:A,padding:2}),e[51]=A,e[52]=ye,e[53]=Re,e[54]=Te):Te=e[54];let Ce;e[55]!==ue||e[56]!==Te?(Ce=l.jsx(te,{padding:1,children:l.jsx(dt,{animate:!0,content:ue,fallbackPlacements:ve,padding:2,placement:"bottom",portal:!0,children:Te})}),e[55]=ue,e[56]=Te,e[57]=Ce):Ce=e[57];let Ie;e[58]!==h||e[59]!==k||e[60]!==K?(Ie=l.jsx(te,{padding:1,children:l.jsx(po,{openPopup:h,previewLocationOrigin:k,previewLocationRoute:K})}),e[58]=h,e[59]=k,e[60]=K,e[61]=Ie):Ie=e[61];let _e;e[62]!==u||e[63]!==k||e[64]!==K||e[65]!==Ce||e[66]!==Ie?(_e=l.jsx(te,{flex:1,marginX:1,children:l.jsx(ho,{prefix:Ce,onChange:u,origin:k,suffix:Ie,value:K})}),e[62]=u,e[63]=k,e[64]=K,e[65]=Ce,e[66]=Ie,e[67]=_e):_e=e[67];const Oe=tn[d==="connected"?x:"previewDrafts"];let Se;e[68]!==g||e[69]!==Oe?(Se=g(Oe),e[68]=g,e[69]=Oe,e[70]=Se):Se=e[70];const Me=d==="reconnecting"&&a.status!=="loaded",ze=d!=="connected";let O;e[71]!==Se||e[72]!==Me||e[73]!==ze?(O=l.jsx(be,{fontSize:1,iconRight:Fs,mode:"bleed",padding:2,space:2,text:Se,loading:Me,disabled:ze}),e[71]=Se,e[72]=Me,e[73]=ze,e[74]=O):O=e[74];let N;e[75]===Symbol.for("react.memo_cache_sentinel")?(N={maxWidth:240},e[75]=N):N=e[75];let L;e[76]!==y?(L=()=>y("previewDrafts"),e[76]=y,e[77]=L):L=e[77];const ht=x==="previewDrafts";let ke;e[78]===Symbol.for("react.memo_cache_sentinel")?(ke=l.jsx(te,{flex:"none",children:l.jsx(q,{size:1,children:f.createElement(nr.previewDrafts)})}),e[78]=ke):ke=e[78];let Le;e[79]!==g?(Le=g(tn.previewDrafts),e[79]=g,e[80]=Le):Le=e[80];let De;e[81]!==Le?(De=l.jsx(q,{size:1,weight:"medium",children:Le}),e[81]=Le,e[82]=De):De=e[82];let Ue;e[83]!==g?(Ue=g("preview-frame.perspective.previewDrafts.text"),e[83]=g,e[84]=Ue):Ue=e[84];let We;e[85]!==Ue?(We=l.jsx(q,{muted:!0,size:1,children:Ue}),e[85]=Ue,e[86]=We):We=e[86];let Ne;e[87]!==De||e[88]!==We?(Ne=l.jsxs(je,{flex:1,space:2,children:[De,We]}),e[87]=De,e[88]=We,e[89]=Ne):Ne=e[89];const qt=x==="previewDrafts"?1:0;let qe;e[90]!==qt?(qe={opacity:qt},e[90]=qt,e[91]=qe):qe=e[91];let xt;e[92]===Symbol.for("react.memo_cache_sentinel")?(xt=l.jsx(Dn,{}),e[92]=xt):xt=e[92];let Ve;e[93]!==qe?(Ve=l.jsx(te,{flex:"none",children:l.jsx(q,{muted:!0,size:1,style:qe,children:xt})}),e[93]=qe,e[94]=Ve):Ve=e[94];let Fe;e[95]!==Ne||e[96]!==Ve?(Fe=l.jsxs(J,{align:"flex-start",gap:3,children:[ke,Ne,Ve]}),e[95]=Ne,e[96]=Ve,e[97]=Fe):Fe=e[97];let Ke;e[98]!==L||e[99]!==ht||e[100]!==Fe?(Ke=l.jsx(ln,{fontSize:1,onClick:L,padding:3,pressed:ht,tone:tr.previewDrafts,children:Fe}),e[98]=L,e[99]=ht,e[100]=Fe,e[101]=Ke):Ke=e[101];let He;e[102]!==y?(He=()=>y("published"),e[102]=y,e[103]=He):He=e[103];const Vt=x==="published";let wt;e[104]===Symbol.for("react.memo_cache_sentinel")?(wt=l.jsx(te,{flex:"none",children:l.jsx(q,{size:1,children:f.createElement(nr.published)})}),e[104]=wt):wt=e[104];let Be;e[105]!==g?(Be=g(tn.published),e[105]=g,e[106]=Be):Be=e[106];let Ge;e[107]!==Be?(Ge=l.jsx(q,{size:1,weight:"medium",children:Be}),e[107]=Be,e[108]=Ge):Ge=e[108];let Xe;e[109]!==g?(Xe=g("preview-frame.perspective.published.text"),e[109]=g,e[110]=Xe):Xe=e[110];let Je;e[111]!==Xe?(Je=l.jsx(q,{muted:!0,size:1,children:Xe}),e[111]=Xe,e[112]=Je):Je=e[112];let Qe;e[113]!==Ge||e[114]!==Je?(Qe=l.jsxs(je,{flex:1,space:2,children:[Ge,Je]}),e[113]=Ge,e[114]=Je,e[115]=Qe):Qe=e[115];const Ft=x==="published"?1:0;let Ye;e[116]!==Ft?(Ye={opacity:Ft},e[116]=Ft,e[117]=Ye):Ye=e[117];let _t;e[118]===Symbol.for("react.memo_cache_sentinel")?(_t=l.jsx(Dn,{}),e[118]=_t):_t=e[118];let Ze;e[119]!==Ye?(Ze=l.jsx(te,{flex:"none",children:l.jsx(q,{muted:!0,size:1,style:Ye,children:_t})}),e[119]=Ye,e[120]=Ze):Ze=e[120];let et;e[121]!==Qe||e[122]!==Ze?(et=l.jsxs(J,{align:"flex-start",gap:3,children:[wt,Qe,Ze]}),e[121]=Qe,e[122]=Ze,e[123]=et):et=e[123];let tt;e[124]!==He||e[125]!==Vt||e[126]!==et?(tt=l.jsx(ln,{fontSize:1,onClick:He,padding:3,pressed:Vt,tone:tr.published,children:et}),e[124]=He,e[125]=Vt,e[126]=et,e[127]=tt):tt=e[127];let nt;e[128]!==Ke||e[129]!==tt?(nt=l.jsxs(ur,{style:N,children:[Ke,tt]}),e[128]=Ke,e[129]=tt,e[130]=nt):nt=e[130];let St;e[131]===Symbol.for("react.memo_cache_sentinel")?(St={animate:!0,constrainSize:!0,placement:"bottom",portal:!0},e[131]=St):St=e[131];let rt;e[132]!==O||e[133]!==nt?(rt=l.jsx(J,{align:"center",flex:"none",gap:1,padding:1,children:l.jsx(dr,{button:O,id:"perspective-menu",menu:nt,popover:St})}),e[132]=O,e[133]=nt,e[134]=rt):rt=e[134];const Kt=R==="desktop"?"narrow":"full";let st;e[135]!==g||e[136]!==Kt?(st=g("preview-frame.viewport-button.tooltip",{context:Kt}),e[135]=g,e[136]=Kt,e[137]=st):st=e[137];let it;e[138]!==st?(it=l.jsx(q,{size:1,children:st}),e[138]=st,e[139]=it):it=e[139];let Pt;e[140]===Symbol.for("react.memo_cache_sentinel")?(Pt=["bottom-start"],e[140]=Pt):Pt=e[140];let at;e[141]!==g?(at=g("preview-frame.viewport-button.aria-label"),e[141]=g,e[142]=at):at=e[142];const Ht=R==="desktop"?Ks:Hs;let ot;e[143]!==at||e[144]!==Ht||e[145]!==I?(ot=l.jsx(be,{"aria-label":at,fontSize:1,icon:Ht,mode:"bleed",onClick:I,padding:2}),e[143]=at,e[144]=Ht,e[145]=I,e[146]=ot):ot=e[146];let ct;e[147]!==it||e[148]!==ot?(ct=l.jsx(J,{align:"center",flex:"none",gap:1,children:l.jsx(dt,{animate:!0,content:it,fallbackPlacements:Pt,padding:2,placement:"bottom",portal:!0,children:ot})}),e[147]=it,e[148]=ot,e[149]=ct):ct=e[149];let lt;e[150]!==n||e[151]!==s||e[152]!==r||e[153]!==c||e[154]!==x||e[155]!==K?(lt=n&&l.jsx(J,{align:"center",flex:"none",gap:1,paddingX:1,children:l.jsx(Wr,{canToggleSharePreviewAccess:s,canUseSharedPreviewAccess:r,previewLocationRoute:K,initialUrl:c,perspective:x})}),e[150]=n,e[151]=s,e[152]=r,e[153]=c,e[154]=x,e[155]=K,e[156]=lt):lt=e[156];let jt;return e[157]!==fe||e[158]!==_e||e[159]!==G||e[160]!==rt||e[161]!==ct||e[162]!==lt?(jt=l.jsxs(l.Fragment,{children:[G,fe,_e,rt,ct,lt]}),e[157]=fe,e[158]=_e,e[159]=G,e[160]=rt,e[161]=ct,e[162]=lt,e[163]=jt):jt=e[163],jt},_o=t=>{var c;const e=z(6),n=Po;let s;e[0]!==t?(s=(c=t.options)!=null&&c.component?f.createElement(t.options.component,{...t,renderDefault:n}):n(t),e[0]=t,e[1]=s):s=e[1];const r=s;let i;e[2]===Symbol.for("react.memo_cache_sentinel")?(i={position:"relative"},e[2]=i):i=e[2];let a;e[3]===Symbol.for("react.memo_cache_sentinel")?(a={minHeight:0},e[3]=a):a=e[3];let o;return e[4]!==r?(o=l.jsx(oe,{flex:"none",padding:2,borderBottom:!0,style:i,children:l.jsx(J,{align:"center",style:a,children:r})}),e[4]=r,e[5]=o):o=e[5],o};function So(t){const e=z(2);let n;return e[0]!==t?(n=()=>l.jsx(_o,{...t}),e[0]=t,e[1]=n):n=e[1],n}function Po(t){return f.createElement(wo,t)}const nn=bt(J),Nr=f.memo(f.forwardRef(function(t,e){const{dispatch:n,iframe:s,header:r,initialUrl:i,loadersConnection:a,overlaysConnection:o,viewport:c}=t,{t:d}=xe(we),{devMode:p}=gn(),u=is(),m=f.useRef(null),h=So({...t,iframeRef:m,options:r});f.useImperativeHandle(e,()=>m.current);const b=s.status==="loading"||s.status==="reloading",[x,v]=f.useState(!1),y=s.status==="refreshing",[_,S]=f.useState(!1),w=b||y||o==="connecting",E=f.useCallback(()=>{m.current&&(m.current.src=i.toString(),n({type:mr}))},[n,i]),R=f.useCallback(()=>{T(!0)},[]),[j,T]=f.useState(!1),[g,P]=f.useState(!1);f.useEffect(()=>{if(!(b||y)&&(o==="connecting"||o==="reconnecting")){const U=setTimeout(()=>{P(!0)},5e3);return()=>clearTimeout(U)}},[o,b,y]),f.useEffect(()=>{if(!(b||y||!g)){if(o==="connected"&&(S(!1),P(!1),v(!1),T(!1)),o==="connecting"){const U=setTimeout(()=>{v(!0),console.error("Unable to connect to visual editing. Make sure you've setup '@sanity/visual-editing' correctly")},zn);return()=>clearTimeout(U)}if(o==="reconnecting"){const U=setTimeout(()=>{v(!0),S(!0)},zn);return()=>clearTimeout(U)}o==="disconnected"&&S(!0)}},[b,o,y,g]);const I=f.useCallback(()=>{n({type:fr})},[n]);f.useEffect(()=>{if(!m.current)return;const U=m.current;function K(){U===document.activeElement&&U.dispatchEvent(new MouseEvent("mousedown",{bubbles:!0,cancelable:!0}))}return window.addEventListener("blur",K),()=>{window.removeEventListener("blur",K)}},[]);const C=f.useMemo(()=>(b||o==="connecting"&&s.status!=="refreshing")&&!j,[j,s.status,b,o]),k=f.useSyncExternalStore(f.useCallback(()=>()=>{},[]),()=>CSS.supports("(view-transition-name: test)")),$=f.useMemo(()=>[C?"background":"active",b?"reloading":"idle",k?"":c,g&&!j?"timedOut":""],[k,j,b,C,g,c]),[A,D]=f.useState(c),[M,W]=f.useState(rn[c]);return f.useEffect(()=>{if(k&&c!==A){const U=()=>{D(c),W(rn[c])};!u&&"startViewTransition"in document&&typeof document.startViewTransition=="function"?document.startViewTransition(()=>as.flushSync(()=>U())):U()}},[k,u,A,c]),l.jsx(ii,{transition:u?{duration:0}:void 0,children:l.jsxs(os,{delay:1e3,children:[l.jsx(h,{}),l.jsx(oe,{flex:1,tone:"transparent",children:l.jsxs(J,{align:"center",height:"fill",justify:"center",padding:(k?A:c)==="desktop"?0:2,sizing:"border",style:{position:"relative",cursor:w?"wait":void 0},children:[l.jsx(hr,{children:!_&&!b&&!y&&g&&!j?l.jsx(nn,{initial:"initial",animate:"animate",exit:"exit",variants:rr,justify:"center",align:"center",style:{inset:"0",position:"absolute",backdropFilter:x?"blur(16px) saturate(0.5) grayscale(0.5)":"blur(2px)",transition:"backdrop-filter 0.2s ease-in-out",WebkitBackdropFilter:x?"blur(16px) saturate(0.5) grayscale(0.5)":"blur(2px)",WebkitTransition:"-webkit-backdrop-filter 0.2s ease-in-out",zIndex:1},children:l.jsxs(J,{style:{...zt[c]},justify:"center",align:"center",direction:"column",gap:4,children:[x&&l.jsx(be,{disabled:!0,fontSize:1,mode:"ghost",text:d("preview-frame.continue-button.text"),style:{opacity:0}}),l.jsx(oe,{radius:2,tone:x?"caution":"inherit",padding:4,shadow:1,children:l.jsxs(J,{justify:"center",align:"center",direction:"column",gap:4,children:[l.jsx(kt,{muted:!0}),l.jsx(q,{muted:!0,size:1,children:x?d("preview-frame.status",{context:"timeout"}):d("preview-frame.status",{context:"connecting"})})]})}),x&&l.jsx(be,{fontSize:1,tone:"critical",onClick:R,text:d("preview-frame.continue-button.text")})]})}):(b||o==="connecting"&&s.status!=="refreshing")&&!j?l.jsx(nn,{initial:"initial",animate:"animate",exit:"exit",variants:rr,justify:"center",align:"center",style:{inset:"0",position:"absolute"},children:l.jsxs(J,{style:{...zt[c]},justify:"center",align:"center",direction:"column",gap:4,children:[l.jsx(kt,{muted:!0}),l.jsx(q,{muted:!0,size:1,children:d("preview-frame.status",{context:"loading"})})]})}):_&&!j?l.jsx(nn,{initial:"initial",animate:"animate",exit:"exit",variants:jo,justify:"center",align:"center",style:{background:"var(--card-bg-color)",inset:"0",position:"absolute"},children:l.jsx(On,{flex:1,message:d("preview-frame.connection.error.text"),onRetry:E,onContinueAnyway:R,children:p&&l.jsxs(l.Fragment,{children:[o!=="connected"&&l.jsx(oe,{padding:3,radius:2,tone:"critical",children:l.jsxs(je,{space:3,children:[l.jsx(At,{muted:!0,size:0,children:d("preview-frame.overlay.connection-status.label")}),l.jsx($t,{size:1,children:d("channel.status",{context:o})})]})}),a!=="connected"&&l.jsx(oe,{padding:3,radius:2,tone:"critical",children:l.jsxs(je,{space:3,children:[l.jsx(At,{muted:!0,size:0,children:d("preview-frame.loader.connection-status.label")}),l.jsx($t,{size:1,children:d("channel.status",{context:a})})]})})]})})}):null}),l.jsx(uo,{animate:$,initial:["background"],onLoad:I,preventClick:C,ref:m,src:i.toString(),style:M,variants:rn})]})})]})})}));Nr.displayName="Memo(ForwardRef(Preview))";const zt={desktop:{width:"100%",height:"100%"},mobile:{width:375,height:650}},rr={initial:{opacity:1},animate:{opacity:[0,0,1]},exit:{opacity:[1,0,0]}},jo={initial:{opacity:1},animate:{opacity:[0,0,1]},exit:{opacity:[1,0,0]}},rn={desktop:{...zt.desktop,boxShadow:"0 0 0 0px var(--card-border-color)"},mobile:{...zt.mobile,boxShadow:"0 0 0 1px var(--card-border-color)"},background:{opacity:0,scale:1},idle:{scale:1},reloading:{scale:[1,1,1,.98]},active:{opacity:[0,0,1],scale:1},timedOut:{opacity:[0,0,1]}};function Eo(t,e,n,s){const r=z(5),i=f.useRef(n),a=br(e);let o,c;r[0]!==a||r[1]!==s||r[2]!==t?(o=()=>{const d=i.current;if(i.current=t,t!==d)return a(t,d)},c=[a,s,t],r[0]=a,r[1]=s,r[2]=t,r[3]=o,r[4]=c):(o=r[3],c=r[4]),f.useEffect(o,c)}const Ro=function(t){const e=z(4),{documentId:n,documentType:s,navigate:r,perspective:i,documentRevision:a}=t,o=Cs(n,s);let c;return e[0]!==a||e[1]!==o||e[2]!==r?(c=d=>{let p;if(d==="published"&&o.published){const{_updatedAt:u,_rev:m}=o.published;p=`${u}/${m}`}a!==p&&r({},{rev:p},!0)},e[0]=a,e[1]=o,e[2]=r,e[3]=c):c=e[3],Eo(i,c),null};function To(){let t=!1;return(...e)=>{t||(console.warn(...e),t=!0)}}const Co=To();function Io(t,e){if(t!=="published"&&t!=="previewDrafts")throw new Error(`Invalid perspective: ${t}`);const[n,s]=f.useState({}),[r,i]=f.useState({}),a=f.useRef(""),o=f.useCallback((c,d,p=[])=>{const u=p.filter(m=>"_projectId"in m&&m._projectId?(Co("Cross dataset references are not supported yet, ignoring source document",m),!1):m);(d==="published"?s:i)(m=>{const h={};for(const x of u)h[x._id]=x;if(a.current!==e.current.url)return a.current=e.current.url,{[c]:h};const b=m[c];return ti(b,h)?m:{...m,[c]:h}})},[e]);return[f.useMemo(()=>{const c=Object.values(t==="published"?n:r).reduce((d,p)=>(Object.values(p).forEach(u=>{d[u._id]=u}),d),{});return Object.values(c)},[t,r,n]),o]}function qr(t,e){return t instanceof Function?t(e):t}function ko(t,e){var n;if(t.resolve){const s=(n=t.resolve(e))==null?void 0:n.filter;return s?`// groq
*[${s}][0]{_id, _type}`:void 0}return"type"in t?`// groq
*[_type == "${t.type}"][0]{_id, _type}`:`// groq
*[${qr(t.filter,e)}][0]{_id, _type}`}function Ao(t,e){var n;return t.resolve?((n=t.resolve(e))==null?void 0:n.params)??e.params:"type"in t?{}:qr(t.params,e)??e.params}function $o(t,e){const n=Array.isArray(t)?t:[t];for(t of n){let s,r=t;if(typeof t=="string")try{const i=new URL(t);s=i.origin,r=i.pathname}catch{}if(!(s&&e.origin!==s))try{const i=Ui(r,{decode:decodeURIComponent})(e.pathname);if(i){const{params:a,path:o}=i;return{origin:s,params:a,path:o}}}catch{throw new Error(`"${t}" is not a valid route pattern`)}}}function Oo(t){var E,R;const e=z(16),{navigate:n,navigationHistory:s,path:r,previewUrl:i,resolvers:a}=t;let o;e[0]!==a?(o=a===void 0?[]:a,e[0]=a,e[1]=o):o=e[1];const c=o,{state:d}=yn();let p;e[2]===Symbol.for("react.memo_cache_sentinel")?(p={apiVersion:Ut},e[2]=p):p=e[2];const u=Dt(p);let m;e[3]!==r||e[4]!==d?(m=r||((R=(E=d._searchParams)==null?void 0:E.find(Mo))==null?void 0:R[1])||"",e[3]=r,e[4]=d,e[5]=m):m=e[5];const h=m,[b,x]=f.useState(void 0),v=f.useRef(void 0);let y;e[6]!==n||e[7]!==s?(y=(j,T)=>{var g,P;(!j||v.current!==j._id)&&(x({document:j,path:T.pathname}),v.current=j==null?void 0:j._id,((g=s.at(-1))==null?void 0:g.id)===((P=s.at(-2))==null?void 0:P.id)&&(n==null||n({id:j==null?void 0:j._id,type:j==null?void 0:j._type})))},e[6]=n,e[7]=s,e[8]=y):y=e[8];const _=br(y);let S,w;return e[9]!==u||e[10]!==_||e[11]!==i||e[12]!==h||e[13]!==c?(S=()=>{const j=typeof i=="string"?i:typeof i=="object"&&(i==null?void 0:i.origin)||location.origin,T=new URL(h,j);if(c.length){let g;for(const P of c){const I=$o(P.route,T);if(I){g={context:I,resolver:P};break}}if(g){const P=ko(g.resolver,g.context),I=Ao(g.resolver,g.context);if(P){const C=new AbortController,k={perspective:"previewDrafts",signal:C.signal};return u.fetch(P,I,k).then($=>_($,T)).catch($=>{$ instanceof Error&&$.name==="AbortError"||(x({document:void 0,path:T.pathname}),v.current=void 0)}),()=>{C.abort()}}}}x(void 0),v.current=void 0},w=[u,_,i,h,c],e[9]=u,e[10]=_,e[11]=i,e[12]=h,e[13]=c,e[14]=S,e[15]=w):(S=e[14],w=e[15]),f.useEffect(S,w),b}function Mo(t){const[e]=t;return e==="preview"}function zo(t){var n;if(t===void 0)return;const e=(n=decodeURIComponent(t))==null?void 0:n.split(".");return e[0]==="drafts"&&e.shift(),e.join(".")}function Lo(t){if(t!==void 0)return Cr.toString(Zi(decodeURIComponent(t)))}function Do(t){return{id:zo(t.id),path:Lo(t.path),type:t.type}}function It(t){return Object.fromEntries(Object.entries(t).filter(([,e])=>e!==void 0&&e!==""&&e!==null))}function Uo({initialPreviewUrl:t,routerNavigate:e,routerState:n,routerSearchParams:s,frameStateRef:r}){const i=f.useMemo(()=>{const{id:u,path:m,type:h}=Do(n);return{id:u,type:h,path:m,preview:s.preview||`${t.pathname}${t.search}`,perspective:s.perspective,viewport:s.viewport,inspect:s.inspect,rev:s.rev,since:s.since,template:s.template,templateParams:s.templateParams,view:s.view,pathKey:s.pathKey,instruction:s.instruction,comment:s.comment,changesInspectorTab:s.changesInspectorTab}},[n,s,t]),a=f.useMemo(()=>It({inspect:i.inspect,path:i.path,rev:i.rev,since:i.since,template:i.template,templateParams:i.templateParams,view:i.view,pathKey:i.pathKey,instruction:i.instruction,comment:i.comment,changesInspectorTab:i.changesInspectorTab}),[i.changesInspectorTab,i.comment,i.inspect,i.instruction,i.path,i.pathKey,i.rev,i.since,i.template,i.templateParams,i.view]),o=f.useMemo(()=>It({perspective:i.perspective,preview:i.preview,viewport:i.viewport}),[i.perspective,i.preview,i.viewport]),c=f.useRef(n);f.useEffect(()=>{c.current=n},[n]);const[d,p]=f.useState([n]);return{navigate:f.useCallback((u,m={},h)=>{u.id&&(u.id=bn(u.id));const{_searchParams:b,...x}=c.current,v=(b||[]).reduce((w,[E,R])=>(w[E]=R,w),{}),y=It({...x,...u}),_=It({...v,...m});x.id!==y.id&&(delete _.template,delete _.templateParams),y._searchParams=Object.entries(_).reduce((w,[E,R])=>[...w,[E,R]],[]);const S=h??_.preview===r.current.url;p(w=>[...w,y]),e(y,{replace:S})},[e,r]),navigationHistory:d,params:i,searchParams:o,structureParams:a}}const Wo=t=>{const e=z(10),[n,s]=f.useState(No);let r;e[0]===Symbol.for("react.memo_cache_sentinel")?(r=u=>{const m=window.open(u,"_blank");m&&s(h=>new Set(h).add(m))},e[0]=r):r=e[0];const i=r;let a,o;e[1]!==t||e[2]!==n?(a=()=>{const u=[];if(n.size&&t)for(const m of n)m&&"closed"in m&&!m.closed&&u.push(t.addTarget(m));return()=>{u.forEach(qo)}},o=[t,n],e[1]=t,e[2]=n,e[3]=a,e[4]=o):(a=e[3],o=e[4]),f.useEffect(a,o);let c,d;e[5]!==n?(c=()=>{if(n.size){const u=setInterval(()=>{const m=new Set;for(const h of n)h&&"closed"in h&&h.closed&&m.add(h);m.size&&s(h=>{const b=new Set(h);for(const x of m)b.delete(x);return b})},Is);return()=>{clearInterval(u)}}},d=[n],e[5]=n,e[6]=c,e[7]=d):(c=e[6],d=e[7]),f.useEffect(c,d);let p;return e[8]!==n?(p={popups:n,open:i},e[8]=n,e[9]=p):p=e[9],p};function No(){return new Set}function qo(t){return t()}function Vo(t,e,n,s,r){var u,m;const i=Dt({apiVersion:Ut}),a=xr(),o=((u=a==null?void 0:a.activeWorkspace)==null?void 0:u.basePath)||"/",c=((m=a==null?void 0:a.activeWorkspace)==null?void 0:m.name)||"default",d=Ko(e,o,c,s),p=Ho(r&&typeof t=="object"||typeof t=="function",d);return $r(async()=>{if(typeof t=="string"){const b=new URL(t,location.origin);let x=b;try{if(s){const v=new URL(s,b);v.origin===b.origin&&(x=v)}}catch{}return location.origin===x.origin&&(x.pathname.startsWith(`${o}/`)||x.pathname===o)?b:x}const h=await(typeof t=="object"?Hi(t):t)({client:i,previewUrlSecret:p,studioPreviewPerspective:n,previewSearchParam:s,studioBasePath:o});return new URL(h,location.origin)},[...d,p])}const Fo=Symbol();function Ko(t,e,n,s){const r=z(12);let i;r[0]!==s?(i=()=>s||"",r[0]=s,r[1]=i):i=r[1];const[a,o]=f.useState(i),c=f.useRef(0);let d,p;r[2]!==a||r[3]!==s?(d=()=>{if(a&&s)return window.clearTimeout(c.current),()=>{c.current=window.setTimeout(()=>{o("")},100)}},p=[a,s],r[2]=a,r[3]=s,r[4]=d,r[5]=p):(d=r[4],p=r[5]),f.useEffect(d,p);const u=fn();let m;const h=u==null?void 0:u.id;let b;return r[6]!==e||r[7]!==a||r[8]!==h||r[9]!==t||r[10]!==n?(b=["@sanity/presentation",e,n,t,h,Fo,a],r[6]=e,r[7]=a,r[8]=h,r[9]=t,r[10]=n,r[11]=b):b=r[11],m=b,m}function Ho(t,e){const n=z(10);let s;n[0]===Symbol.for("react.memo_cache_sentinel")?(s={apiVersion:Ut},n[0]=s):s=n[0];const r=Dt(s),i=fn(),[a,o]=f.useState("");let c;n[1]!==r||n[2]!==(i==null?void 0:i.id)||n[3]!==e||n[4]!==t||n[5]!==a?(c=t?$r(async()=>await Ki(r,"@sanity/presentation",typeof window>"u"?"":location.href,i==null?void 0:i.id),[...e,a]):null,n[1]=r,n[2]=i==null?void 0:i.id,n[3]=e,n[4]=t,n[5]=a,n[6]=c):c=n[6];const d=c;let p,u;return n[7]!==d?(p=()=>{if(!d)return;const m=setTimeout(()=>{f.startTransition(()=>o(d.expiresAt.toString()))},d.expiresAt.getTime()-Date.now());return()=>clearTimeout(m)},u=[d],n[7]=d,n[8]=p,n[9]=u):(p=n[8],u=n[9]),f.useEffect(p,u),(d==null?void 0:d.secret)||null}function sn(){const t=z(4);let e;t[0]===Symbol.for("react.memo_cache_sentinel")?(e=new Map,t[0]=e):e=t[0];const[n,s]=f.useState(e);let r;e:{const d=Array.from(n.values());if(d.find(Xo)){r="connected";break e}const p=d.filter(Go);if(p.length){r=p.some(Bo)?"connecting":"reconnecting";break e}r="idle"}const i=r;let a;t[1]===Symbol.for("react.memo_cache_sentinel")?(a=d=>{s(p=>{var m;const u=new Map(p);if(d.status==="disconnected")u.delete(d.connection);else{const h=((m=u.get(d.connection))==null?void 0:m.hasConnected)||d.status==="connected";u.set(d.connection,{status:d.status,hasConnected:h})}return u})},t[1]=a):a=t[1];const o=a;let c;return t[2]!==i?(c=[i,o],t[2]=i,t[3]=c):c=t[3],c}function Bo(t){const{hasConnected:e}=t;return!e}function Go(t){const{status:e}=t;return e==="handshaking"}function Xo(t){const{status:e}=t;return e==="connected"}const Jo=f.lazy(()=>Ee(()=>import("./LoaderQueries-b8890a0b.js"),["static/LoaderQueries-b8890a0b.js","static/sanity-05ba3066.js","static/hooks-d811cc7e.js","static/DisplayedDocumentBroadcaster-5ec2fcf3.js"]));f.lazy(()=>Ee(()=>import("./LiveQueries-6f74a02c.js"),["static/LiveQueries-6f74a02c.js","static/sanity-05ba3066.js","static/hooks-d811cc7e.js","static/DisplayedDocumentBroadcaster-5ec2fcf3.js"]));const Qo=f.lazy(()=>Ee(()=>import("./PostMessageDocuments-e3918ceb.js"),["static/PostMessageDocuments-e3918ceb.js","static/sanity-05ba3066.js"])),Yo=f.lazy(()=>Ee(()=>import("./PostMessageFeatures-6fac1481.js"),["static/PostMessageFeatures-6fac1481.js","static/sanity-05ba3066.js"])),Zo=f.lazy(()=>Ee(()=>import("./PostMessageRefreshMutations-d42c0d73.js"),["static/PostMessageRefreshMutations-d42c0d73.js","static/sanity-05ba3066.js"])),ec=f.lazy(()=>Ee(()=>import("./PostMessagePerspective-fbd5c0bd.js"),["static/PostMessagePerspective-fbd5c0bd.js","static/sanity-05ba3066.js"])),tc=f.lazy(()=>Ee(()=>import("./PostMessagePreviewSnapshots-3f3c15dc.js"),["static/PostMessagePreviewSnapshots-3f3c15dc.js","static/sanity-05ba3066.js"])),nc=f.lazy(()=>Ee(()=>import("./PostMessageSchema-863789e7.js"),["static/PostMessageSchema-863789e7.js","static/sanity-05ba3066.js"])),rc=pe(J)`
  overflow-x: auto;
`;function sc(t){var _e,Oe,Se,Me,ze;const{canCreateUrlPreviewSecrets:e,canToggleSharePreviewAccess:n,canUseSharedPreviewAccess:s,tool:r}=t,i=(_e=r.options)==null?void 0:_e.components,a=(Oe=r.options)==null?void 0:Oe.previewUrl,o=r.name||fs,{unstable_navigator:c,unstable_header:d}=i||{},{navigate:p,state:u}=yn(),m=vr(Object.fromEntries(u._searchParams||[])),h=Vo(a||"/",o,m.perspective==="published"?"published":"previewDrafts",m.preview||null,e),b=f.useMemo(()=>a&&typeof a=="object"&&"draftMode"in a&&a.draftMode?(console.warn("previewUrl.draftMode is deprecated, use previewUrl.previewMode instead"),a.draftMode.shareAccess!==!1):a&&typeof a=="object"&&"previewMode"in a&&a.previewMode?a.previewMode.shareAccess!==!1:!1,[a]),[x]=f.useState(()=>{var N;const O=(N=r.options)==null?void 0:N.devMode;return typeof O=="function"?O():typeof O=="boolean"?O:typeof window<"u"&&window.location.hostname==="localhost"}),v=f.useMemo(()=>h.origin,[h.origin]),y=f.useRef(null),[_,S]=f.useState(),[w,E]=f.useState(null),R=f.useRef({title:void 0,url:void 0}),{navigate:j,navigationHistory:T,params:g,searchParams:P,structureParams:I}=Uo({initialPreviewUrl:h,routerNavigate:p,routerState:u,routerSearchParams:m,frameStateRef:R}),C=f.useMemo(()=>Or(j,50),[j]),[k,$]=f.useReducer(gs,{},vs),A=f.useMemo(()=>g.perspective?"published":"previewDrafts",[g.perspective]),D=f.useMemo(()=>g.viewport?"mobile":"desktop",[g.viewport]),[M,W]=Io(A,R),U=ys(),K=bs(),G=Oo({navigate:j,navigationHistory:T,path:g.preview,previewUrl:(Se=r.options)==null?void 0:Se.previewUrl,resolvers:(ze=(Me=r.options)==null?void 0:Me.resolve)==null?void 0:ze.mainDocuments}),[re,he]=sn(),[ie,ce]=sn(),[le,ne]=sn(),{open:me}=Wo(_),V=k.iframe.status==="loading";f.useEffect(()=>{var L;const O=(L=y.current)==null?void 0:L.contentWindow;if(!O||V)return;const N=wi({targetOrigin:v});return N.addTarget(O),S(N),()=>{N.destroy(),S(void 0)}},[v,V]),f.useEffect(()=>{if(!_)return;const O=_.createChannel({name:"presentation",heartbeat:!0,connectTo:"visual-editing"},Mt().provide({actors:dn()}));O.on("visual-editing/focus",L=>{"id"in L&&C({type:L.type,id:L.id,path:L.path})}),O.on("visual-editing/navigate",L=>{const{title:ht,url:ke}=L;R.current.url!==ke&&C({},{preview:ke}),R.current={title:ht,url:ke}}),O.on("visual-editing/meta",L=>{R.current.title=L.title}),O.on("visual-editing/toggle",L=>{$({type:xs,enabled:L.enabled})}),O.on("visual-editing/documents",L=>{W("visual-editing",L.perspective,L.documents)}),O.on("visual-editing/refreshing",L=>{L.source==="manual"?clearTimeout(ve.current):L.source==="mutation"&&$({type:Ln})}),O.on("visual-editing/refreshed",()=>{$({type:fr})}),O.onStatus(he);const N=O.start();return E(O),()=>{N(),E(null)}},[_,C,W,he,v]),f.useEffect(()=>{if(!_)return;const O=_.createChannel({name:"presentation",connectTo:"preview-kit",heartbeat:!0},Mt().provide({actors:dn()}));return O.onStatus(ne),O.on("preview-kit/documents",N=>{N.projectId===U&&N.dataset===K&&W("preview-kit",N.perspective,N.documents)}),O.start()},[_,K,U,W,ne,v]);const H=f.useCallback(O=>{C({path:Cr.toString(O)},{},!0)},[C]),F=f.useCallback(O=>{const N=new URL(O,h.origin),L=N.pathname+N.search;N.origin===h.origin&&L!==g.preview&&C({},{preview:L})},[h,g,C]),X=f.useCallback(O=>{C({},O)},[C]);f.useEffect(()=>{g.id&&g.path?w==null||w.post("presentation/focus",{id:g.id,path:g.path}):w==null||w.post("presentation/blur")},[g.id,g.path,w]),f.useEffect(()=>{R.current.url&&g.preview&&R.current.url!==g.preview&&(R.current.url=g.preview,re!=="connected"&&y.current?y.current.src=`${v}${g.preview}`:w==null||w.post("presentation/navigate",{url:g.preview,type:"replace"}))},[re,v,g.preview,w]);const B=f.useCallback(()=>w==null?void 0:w.post("presentation/toggle-overlay"),[w]),[ae,Y]=f.useState(null);f.useEffect(()=>{const O=L=>{Xn(L)&&B()},N=L=>{Xn(L)&&B(),oa(["mod","\\"],L)&&B()};return window.addEventListener("keydown",N),window.addEventListener("keyup",O),()=>{window.removeEventListener("keydown",N),window.removeEventListener("keyup",O)}},[B]);const[Q,se]=f.useState(null),[{navigatorEnabled:de,toggleNavigator:fe},ge]=no({unstable_navigator:c}),ue=f.useRef(g.id);f.useEffect(()=>{g.rev&&ue.current&&g.id!==ue.current&&C({},{rev:void 0}),ue.current=g.id});const ve=f.useRef(),ye=f.useCallback(O=>{if($({type:Ln}),w){ve.current=window.setTimeout(O,300),w.post("presentation/refresh",{source:"manual",livePreviewEnabled:le==="connected"||ie==="connected"});return}O()},[ie,le,w]),Re=ws(),Te=f.useCallback(({id:O,type:N,path:L})=>{if(R.current.url)return{title:R.current.title||R.current.url,name:"edit",params:{id:O,path:L,type:N,inspect:_s,workspace:Re.name,mode:Ss,preview:g.preview}}},[g.preview,Re.name]),Ce=f.useCallback(O=>{C({},{viewport:O==="desktop"?void 0:"mobile"},!0)},[C]),Ie=f.useCallback(O=>{C({},{perspective:O==="previewDrafts"?void 0:O})},[C]);return l.jsxs(l.Fragment,{children:[l.jsx(oo,{devMode:x,name:o,navigate:C,params:g,searchParams:P,structureParams:I,children:l.jsx(eo,{navigate:C,children:l.jsx(ao,{params:g,children:l.jsx(ca,{comlink:w,children:l.jsx(rc,{height:"fill",children:l.jsxs(ba,{children:[l.jsx(ge,{}),l.jsx($n,{id:"preview",minWidth:325,defaultSize:de?50:75,order:3,children:l.jsx(J,{direction:"column",flex:1,height:"fill",ref:se,children:l.jsx(Ps,{element:Q,children:l.jsx(Nr,{canSharePreviewAccess:b,canToggleSharePreviewAccess:n,canUseSharedPreviewAccess:s,dispatch:$,header:d,iframe:k.iframe,initialUrl:h,loadersConnection:ie,navigatorEnabled:de,onPathChange:F,onRefresh:ye,openPopup:me,overlaysConnection:re,previewUrl:g.preview,perspective:A,ref:y,setPerspective:Ie,setViewport:Ce,targetOrigin:v,toggleNavigator:fe,toggleOverlay:B,viewport:D,visualEditing:k.visualEditing})})})}),l.jsx(Za,{documentId:g.id,documentsOnPage:M,documentType:g.type,getCommentIntent:Te,mainDocumentState:G,onFocusPath:H,onStructureParams:X,searchParams:P,setDisplayedDocument:Y,structureParams:I})]})})})})})}),l.jsxs(f.Suspense,{children:[_&&l.jsx(Jo,{controller:_,perspective:A,liveDocument:ae,onDocumentsOnPage:W,onLoadersConnection:ce,documentsOnPage:M}),w&&g.id&&g.type&&l.jsx(Zo,{comlink:w,id:g.id,type:g.type,loadersConnection:ie,previewKitConnection:le}),w&&l.jsx(nc,{comlink:w,perspective:A}),w&&M.length>0&&l.jsx(tc,{comlink:w,perspective:A,refs:M}),w&&l.jsx(Qo,{comlink:w}),w&&l.jsx(Yo,{comlink:w}),w&&l.jsx(ec,{comlink:w,perspective:A}),g.id&&g.type&&l.jsx(Ro,{documentId:g.id,documentRevision:g.rev,documentType:g.type,navigate:C,perspective:A})]})]})}function ic(t){const e=z(16),{t:n}=xe(we),{previewUrl:s}=t.tool.options??{},{push:r}=lr(),i=typeof s=="object"||typeof s=="function",a=ds(),[o,c]=f.useState(null),[d,p]=f.useState(null),[u,m]=f.useState(null),[h,b]=f.useState(null);let x,v;e[0]!==a||e[1]!==i?(x=()=>{if(!i)return;const T=a.checkDocumentPermission("create",{_id:$e,_type:ut}).subscribe(c),g=a.checkDocumentPermission("update",{_id:$e,_type:ut}).subscribe(p),P=a.checkDocumentPermission("read",{_id:$e,_type:ut}).subscribe(m),I=a.checkDocumentPermission("create",{_id:`drafts.${or()}`,_type:xn}).subscribe(b);return()=>{T.unsubscribe(),g.unsubscribe(),P.unsubscribe(),I.unsubscribe()}},v=[a,i],e[0]=a,e[1]=i,e[2]=x,e[3]=v):(x=e[2],v=e[3]),f.useEffect(x,v);const y=h==null?void 0:h.granted;let _,S;if(e[4]!==y||e[5]!==r||e[6]!==n||e[7]!==i?(_=()=>{if(!i||y!==!1)return;const T=requestAnimationFrame(()=>r({closable:!0,status:"error",duration:3e4,title:n("preview-url-secret.missing-grants")}));return()=>cancelAnimationFrame(T)},S=[y,r,n,i],e[4]=y,e[5]=r,e[6]=n,e[7]=i,e[8]=_,e[9]=S):(_=e[8],S=e[9]),f.useEffect(_,S),i&&(!o||typeof o.granted>"u"||!d||typeof d.granted>"u"||!h||!u||typeof u.granted>"u"||typeof h.granted>"u")){let T;return e[10]===Symbol.for("react.memo_cache_sentinel")?(T=l.jsx(yr,{}),e[10]=T):T=e[10],T}const w=y===!0,E=(o==null?void 0:o.granted)===!0&&(d==null?void 0:d.granted)===!0,R=(u==null?void 0:u.granted)===!0;let j;return e[11]!==t||e[12]!==w||e[13]!==E||e[14]!==R?(j=l.jsx(sc,{...t,canCreateUrlPreviewSecrets:w,canToggleSharePreviewAccess:E,canUseSharedPreviewAccess:R}),e[11]=t,e[12]=w,e[13]=E,e[14]=R,e[15]=j):j=e[15],j}var ac=Object.freeze({__proto__:null,default:ic});const pc=Object.freeze(Object.defineProperty({__proto__:null,PresentationToolGrantsCheck:ac,createCompatibilityActors:dn,getQueryCacheKey:ia},Symbol.toStringTag,{value:"Module"}));export{Fn as D,pc as P,dn as a,lc as b,Mt as c,Pi as d,ia as g,dc as p,uc as r,ji as t,ft as w};
