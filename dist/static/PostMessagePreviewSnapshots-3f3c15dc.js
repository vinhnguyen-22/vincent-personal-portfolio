import{a0 as w,a1 as g,r as o,c1 as P,a8 as _,cx as S,aE as x,cy as E,cz as M,cA as k,aJ as y,bV as v,cw as D,ba as R,b5 as U,ao as $,cB as j}from"./sanity-05ba3066.js";function F(u){return w(function(p,t){var a=!1,r=0;p.subscribe(g(t,function(e){return(a||(a=!u(e,r++)))&&t.next(e)}))})}const I=u=>{const{comlink:p,refs:t,perspective:a}=u,r=P(),e=_(),c=o.useMemo(()=>new S,[]),d=o.useMemo(()=>c.asObservable().pipe(x(b=>E(b.map(s=>{const l={...s,_id:M(s._id)},m=a==="previewDrafts"?r.observeForPreview(l,e.get(l._type)).pipe(k(),F(i=>i.snapshot===null)):y,f={...s,_id:v(s._id)},h=r.observeForPreview(f,e.get(f._type));return D(h.pipe(R(m)),m).pipe(U(i=>!!i.snapshot),$(i=>{const n=i.snapshot;return{_id:v(n._id),title:n.title,subtitle:n.subtitle,description:n.description,imageUrl:n.imageUrl}}))}))),j(0)),[r,c,e,a]);return o.useEffect(()=>{const b=d.subscribe(s=>{p.post("presentation/preview-snapshots",{snapshots:s})});return()=>{b.unsubscribe()}},[p,d]),o.useEffect(()=>{c.next(t)},[t,c]),null};var V=o.memo(I);export{V as default};
